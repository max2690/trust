# Telegram Bot â€” Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ Ð¿Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ Ð¸ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐµ

## ðŸš€ Ð—Ð°Ñ‚Ñ€Ð¾Ð½ÑƒÑ‚Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹

### ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð±Ð¾Ñ‚Ð°:
1. `src/lib/telegram-init.ts` â€” Ð»Ð¾Ð³Ð¸ÐºÐ° Ð±Ð¾Ñ‚Ð°, Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚Ñ‡Ð¸ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹, OpenAI Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ñ
2. `src/lib/telegram-init-server.ts` â€” Ð·Ð°Ð¿ÑƒÑÐº Ð±Ð¾Ñ‚Ð° Ð¿Ñ€Ð¸ ÑÑ‚Ð°Ñ€Ñ‚Ðµ ÑÐµÑ€Ð²ÐµÑ€Ð°
3. `src/lib/bot-launcher.ts` â€” Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº (Ð¿Ñ€ÐµÐ´Ð¾Ñ‚Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð´ÑƒÐ±Ð»Ð¸ÐºÐ°Ñ‚Ñ‹)
4. `src/app/layout.tsx` â€” Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚ Ð±Ð¾Ñ‚Ð° Ð¿Ñ€Ð¸ ÑÑ‚Ð°Ñ€Ñ‚Ðµ (Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¾Ð¹ Ð½Ð° Ð²Ñ€ÐµÐ¼Ñ ÑÐ±Ð¾Ñ€ÐºÐ¸)

### API ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ñ‹:
5. `src/app/api/verification/telegram/start/route.ts` â€” Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð´Ð° Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸
6. `src/app/api/verification/telegram/complete/route.ts` â€” Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸
7. `src/app/api/health/route.ts` â€” health check + Ð·Ð°Ð¿ÑƒÑÐº Ð±Ð¾Ñ‚Ð° Ð¿Ñ€Ð¸ Ð¿ÐµÑ€Ð²Ð¾Ð¼ Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ
8. `src/app/api/bot/init/route.ts` â€” Ñ€ÑƒÑ‡Ð½Ð°Ñ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð±Ð¾Ñ‚Ð° (Ð¾Ð¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾)

### ÐšÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ñ‹:
9. `src/components/verification/TelegramVerification.tsx` â€” UI Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸
10. `src/app/auth/signup/customer/page.tsx` â€” ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð·Ð°ÐºÐ°Ð·Ñ‡Ð¸ÐºÐ°
11. `src/app/auth/signup/executor/page.tsx` â€” ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¸ÑÐ¿Ð¾Ð»Ð½Ð¸Ñ‚ÐµÐ»Ñ

### ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ:
12. `env.example` â€” Ð¿Ñ€Ð¸Ð¼ÐµÑ€ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ… Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
13. `.env.local` â€” Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ (ÑÐ¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ)

---

## ðŸ“‹ ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ (.env.local)

```env
DATABASE_URL="file:./prisma/dev.db"

NEXTAUTH_SECRET="c7b3f9e2a8d2412fb4f3f2a1e8d97028"
NEXTAUTH_URL="http://109.69.58.185:3000"
AUTH_TRUST_HOST=true

TELEGRAM_BOT_TOKEN="8345454942:AAFoOh3asQ104UUvIxNgMTpLCwwFI1oIJDY"
TELEGRAM_BOT_USERNAME="MBTRUST_bot"

OPENAI_API_KEY="sk-proj-..."

AUTH_MODE=telegram-only
NEXT_PUBLIC_APP_URL="http://109.69.58.185:3000"
```

---

## ðŸ”§ Ð˜Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ Ð¿Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ

### 1. Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»Ñ‹ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€

```bash
cd /var/www/mb-trust

# Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ Ð¸Ð·Ð¼ÐµÐ½Ñ‘Ð½Ð½Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ (Ð²ÑÐµ 13 Ñ„Ð°Ð¹Ð»Ð¾Ð² Ð²Ñ‹ÑˆÐµ)
```

### 2. Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ .env.local

```bash
cat > .env.local <<'EOF'
DATABASE_URL="file:./prisma/dev.db"

NEXTAUTH_SECRET="c7b3f9e2a8d2412fb4f3f2a1e8d97028"
NEXTAUTH_URL="http://109.69.58.185:3000"
AUTH_TRUST_HOST=true

TELEGRAM_BOT_TOKEN="8345454942:AAFoOh3asQ104UUvIxNgMTpLCwwFI1oIJDY"
TELEGRAM_BOT_USERNAME="MBTRUST_bot"

OPENAI_API_KEY="sk-proj-Ð²Ð°Ñˆ-ÐºÐ»ÑŽÑ‡"

AUTH_MODE=telegram-only
NEXT_PUBLIC_APP_URL="http://109.69.58.185:3000"
EOF
```

### 3. ÐŸÐµÑ€ÐµÑÐ¾Ð±Ñ€Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚

```bash
npm ci
npx prisma generate
npm run build
```

### 4. Ð˜ÑÐ¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°

```bash
sudo chown -R www-data:www-data /var/www/mb-trust/.next
sudo chmod -R 755 /var/www/mb-trust/.next
```

### 5. ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ ÑÐµÑ€Ð²Ð¸Ñ

```bash
sudo systemctl restart mb-trust
```

### 6. Ð’Ñ‹Ð·Ð²Ð°Ñ‚ÑŒ health check Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð±Ð¾Ñ‚Ð°

```bash
sleep 2
curl http://localhost:3000/api/health
```

### 7. ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸

```bash
journalctl -u mb-trust -f
```

Ð”Ð¾Ð»Ð¶Ð½Ñ‹ Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑŒÑÑ ÑÑ‚Ñ€Ð¾ÐºÐ¸:
- `ðŸ¤– Ð—Ð°Ð¿ÑƒÑÐº Telegram Ð±Ð¾Ñ‚Ð°...`
- `âœ… Telegram Ð±Ð¾Ñ‚ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½`

---

## ðŸ” Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ° Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: Ð‘Ð¾Ñ‚ Ð½Ðµ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ÑÑ

**ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ:**
```bash
# ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
systemctl show mb-trust | grep EnvironmentFile
cat .env.local | grep TELEGRAM_BOT_TOKEN

# Ð›Ð¾Ð³Ð¸ ÑÑ‚Ð°Ñ€Ñ‚Ð°
journalctl -u mb-trust -n 100 | grep -E "Telegram|BOT|ðŸ¤–"

# Ð—Ð°Ð¿ÑƒÑ‰ÐµÐ½ Ð»Ð¸ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð¾Ð´Ð¸Ð½ Ð¿Ñ€Ð¾Ñ†ÐµÑÑ
ps aux | grep node | grep mb-trust
```

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
- Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ `TELEGRAM_BOT_TOKEN` ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½
- Ð’Ñ‹Ð·Ð¾Ð²Ð¸Ñ‚Ðµ `curl http://localhost:3000/api/health`

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: ÐšÐ¾Ð´ Ð½ÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹

**ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð² Ð»Ð¾Ð³Ð°Ñ…:**
```bash
journalctl -u mb-trust -f | grep -E "\[VERIFY\]|\[BOT\]"
```

Ð”Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ ÑÑ‚Ñ€Ð¾ÐºÐ¸:
- `[VERIFY-START] Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½ ÐºÐ¾Ð´: ...`
- `[VERIFY] ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð´Ð°: ...`
- `[BOT] ÐšÐ¾Ð´ ... Ð¿Ñ€Ð¸Ð½ÑÑ‚/Ð½ÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹`

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
- ÐšÐ¾Ð´Ñ‹ Ñ‚ÐµÐ¿ÐµÑ€ÑŒ Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÑŽÑ‚ÑÑ Ð² Ð²ÐµÑ€Ñ…Ð½ÐµÐ¼ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ðµ
- ÐŸÐ¾Ð¸ÑÐº case-insensitive (Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ ÑÐ¾ ÑÑ‚Ð°Ñ€Ñ‹Ð¼Ð¸ ÐºÐ¾Ð´Ð°Ð¼Ð¸)
- Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹ ÐºÐ¾Ð´ Ð½Ð° ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ðµ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: Ð‘Ð¾Ñ‚ Ð½Ðµ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚

**ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ:**
```bash
# Ð‘Ð¾Ñ‚ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½
journalctl -u mb-trust | grep "Telegram Ð±Ð¾Ñ‚ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½"

# Ð•ÑÑ‚ÑŒ Ð»Ð¸ ÑÐµÑÑÐ¸Ñ Ð´Ð»Ñ Ð²Ð°ÑˆÐµÐ³Ð¾ chat_id
journalctl -u mb-trust | grep "Ð¿Ñ€Ð¸Ð½ÑÑ‚, Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð´Ð¸Ð°Ð»Ð¾Ð³"

# Ð”Ð¾ÑÑ‚ÑƒÐ¿ Ðº api.telegram.org
curl -s https://api.telegram.org
```

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
- ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ `/start` Ð² Ð±Ð¾Ñ‚Ðµ
- Ð˜Ð»Ð¸ Ð¿ÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð¿Ð¾ deep-link Ð¸Ð· ÑÑ‚Ñ€Ð°Ð½Ð¸Ñ†Ñ‹ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: Ð’Ð¾Ð¿Ñ€Ð¾ÑÑ‹ Ð¾ÑÑ‚Ð°ÑŽÑ‚ÑÑ Ð²Ð¸ÑÐµÑ‚ÑŒ

**Ð’ Ð»Ð¾Ð³Ð°Ñ… ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ:**
```bash
journalctl -u mb-trust -f | grep "\[BOT\] ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ"
journalctl -u mb-trust -f | grep "\[BOT\] Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ"
```

ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚, ÐºÐ°ÐºÐ¸Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð·Ð²Ð»ÐµÐºÐ°ÑŽÑ‚ÑÑ Ð¸Ð· Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð².

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
- ÐžÑ‚Ð²ÐµÑ‡Ð°Ð¹Ñ‚Ðµ Ñ‡Ñ‘Ñ‚ÐºÐ¾ (Ð½Ð°Ð¿Ñ€Ð¸Ð¼ÐµÑ€: "Ð¯ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº", "ÐœÐ¾ÑÐºÐ²Ð°", "1000 Ð¿Ð¾Ð´Ð¿Ð¸ÑÑ‡Ð¸ÐºÐ¾Ð²", "Ð´Ð°")
- Ð‘Ð¾Ñ‚ Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐµÑ‚ OpenAI Ð´Ð»Ñ Ð¿Ð¾Ð½Ð¸Ð¼Ð°Ð½Ð¸Ñ â€” ÐµÑÐ»Ð¸ ÐºÐ»ÑŽÑ‡ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ð¹, Ð´Ð¾Ð»Ð¶Ð½Ð¾ Ñ€Ð°Ð±Ð¾Ñ‚Ð°Ñ‚ÑŒ

### ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ð°: Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð½Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÑ‚ÑÑ

**ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ:**
```bash
journalctl -u mb-trust -f | grep "\[BOT\] Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»Ð½Ñ‹Ðµ"
journalctl -u mb-trust -f | grep "\[BOT\] Ð—Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÐ¼ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸ÑŽ"
```

**Ð ÐµÑˆÐµÐ½Ð¸Ðµ:**
- Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ð»Ð¸ Ð½Ð° Ð²ÑÐµ 6 Ð²Ð¾Ð¿Ñ€Ð¾ÑÐ¾Ð²
- ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð² Ð»Ð¾Ð³Ð°Ñ…, Ñ‡Ñ‚Ð¾ Ð²ÑÐµ Ð¿Ð¾Ð»Ñ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹
- ÐŸÐ¾ÑÐ»Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð´Ð¾Ð»Ð¶Ð½Ð° Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑŒÑÑ ÑÑ‚Ñ€Ð¾ÐºÐ° `[BOT] Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸`

---

## âœ… Ð£ÑÐ¿ÐµÑˆÐ½Ñ‹Ð¹ Ñ„Ð»Ð¾Ñƒ

1. ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð·Ð°Ð¿Ð¾Ð»Ð½ÑÐµÑ‚ Ñ„Ð¾Ñ€Ð¼Ñƒ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ â†’ ÑÐ¾Ð·Ð´Ð°Ñ‘Ñ‚ÑÑ User (isVerified=false)
2. ÐŸÐ¾ÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ÑÑ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚ TelegramVerification â†’ Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐµÑ‚ÑÑ ÐºÐ¾Ð´
3. ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´Ð¸Ñ‚ Ð¿Ð¾ ÑÑÑ‹Ð»ÐºÐµ â†’ Ð±Ð¾Ñ‚ Ð¿Ð¾Ð»ÑƒÑ‡Ð°ÐµÑ‚ `/start link_ÐšÐžÐ”`
4. Ð‘Ð¾Ñ‚ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ ÐºÐ¾Ð´ Ñ‡ÐµÑ€ÐµÐ· API â†’ ÑÐ¾Ð·Ð´Ð°Ñ‘Ñ‚ ÑÐµÑÑÐ¸ÑŽ
5. Ð‘Ð¾Ñ‚ Ð·Ð°Ð´Ð°Ñ‘Ñ‚ Ð²Ð¾Ð¿Ñ€Ð¾ÑÑ‹ â†’ ÑÐ¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ñ‡ÐµÑ€ÐµÐ· OpenAI
6. ÐšÐ¾Ð³Ð´Ð° Ð²ÑÐµ 6 Ð¿Ð¾Ð»ÐµÐ¹ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹ â†’ Ð±Ð¾Ñ‚ Ð²Ñ‹Ð·Ñ‹Ð²Ð°ÐµÑ‚ `/api/verification/telegram/complete`
7. API Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ User (isVerified=true, telegramId=...)
8. Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ ÐºÐ°Ð¶Ð´Ñ‹Ðµ 2 ÑÐµÐº Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑÐµÑ‚ isVerified â†’ Ð¿ÐµÑ€ÐµÐ½Ð°Ð¿Ñ€Ð°Ð²Ð»ÑÐµÑ‚ Ð½Ð° Ð´Ð°ÑˆÐ±Ð¾Ñ€Ð´

---

## ðŸ› Debug ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ ÐºÐ¾Ð´ ÐµÑÑ‚ÑŒ Ð² Ð‘Ð”
sqlite3 prisma/dev.db "SELECT id, name, verificationCode, isVerified FROM users WHERE verificationCode IS NOT NULL;"

# Ð¢ÐµÑÑ‚ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ Ñ‡ÐµÑ€ÐµÐ· Ð±Ð¾Ñ‚Ð°
curl -X POST http://localhost:3000/api/telegram/test \
  -H "Content-Type: application/json" \
  -d '{"telegramId":"7180687130","code":"TEST123"}'

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ‚ÑƒÑ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
curl "http://localhost:3000/api/users?userId=USER_ID"
```

---

## ðŸ“ Ð§ÐµÐºÐ»Ð¸ÑÑ‚ Ð¿Ð¾ÑÐ»Ðµ Ð´ÐµÐ¿Ð»Ð¾Ñ

- [ ] Ð‘Ð¾Ñ‚ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ð½ (Ð»Ð¾Ð³Ð¸: "âœ… Telegram Ð±Ð¾Ñ‚ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½")
- [ ] ÐŸÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ (`TELEGRAM_BOT_TOKEN`, `OPENAI_API_KEY`, `NEXTAUTH_URL`)
- [ ] Health check Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ (`curl http://localhost:3000/api/health`)
- [ ] Ð‘Ð¾Ñ‚ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ Ð½Ð° `/start` Ð² Telegram
- [ ] Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð´Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ (Ð»Ð¾Ð³Ð¸: "[VERIFY-START] Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½ ÐºÐ¾Ð´")
- [ ] ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð´Ð° Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ (Ð»Ð¾Ð³Ð¸: "[VERIFY] ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð´Ð°", "[BOT] ÐšÐ¾Ð´ ... Ð¿Ñ€Ð¸Ð½ÑÑ‚")
- [ ] OpenAI Ð¸Ð·Ð²Ð»ÐµÐºÐ°ÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ (Ð»Ð¾Ð³Ð¸: "[BOT] ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ")
- [ ] Ð—Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ (Ð»Ð¾Ð³Ð¸: "[BOT] Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»Ð½Ñ‹Ðµ", "Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ")
- [ ] Ð¡Ñ‚Ñ€Ð°Ð½Ð¸Ñ†Ð° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ÑÑ (Ð¿ÐµÑ€ÐµÑ…Ð¾Ð´ Ð½Ð° dashboard)

