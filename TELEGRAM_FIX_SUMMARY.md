# Telegram Bot â€” Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¸Ñ Ð¸ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ

## ðŸŽ¯ Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹

### 1. Ð‘Ð¾Ñ‚ Ð½Ðµ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑ‚ÑÑ
- âœ… Ð”Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ launcher (`bot-launcher.ts`)
- âœ… Ð—Ð°Ð¿ÑƒÑÐº Ñ‡ÐµÑ€ÐµÐ· `/api/health` Ð¿Ñ€Ð¸ Ð¿ÐµÑ€Ð²Ð¾Ð¼ Ð·Ð°Ð¿Ñ€Ð¾ÑÐµ
- âœ… Ð—Ð°Ñ‰Ð¸Ñ‚Ð° Ð¾Ñ‚ Ð¼Ð½Ð¾Ð¶ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ð¹ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ð¸ Ð¿Ñ€Ð¸ ÑÐ±Ð¾Ñ€ÐºÐµ

### 2. ÐšÐ¾Ð´ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð½Ðµ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ñ‘Ñ‚ÑÑ
- âœ… Ð“ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ Ð² Ð²ÐµÑ€Ñ…Ð½ÐµÐ¼ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ðµ: `randomBytes().toUpperCase()`
- âœ… ÐÐ¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐµ
- âœ… Case-insensitive Ð¿Ð¾Ð¸ÑÐº Ð´Ð»Ñ ÑÐ¾Ð²Ð¼ÐµÑÑ‚Ð¸Ð¼Ð¾ÑÑ‚Ð¸

### 3. OpenAI Ð½Ðµ Ð¸Ð·Ð²Ð»ÐµÐºÐ°ÐµÑ‚ Ð´Ð°Ð½Ð½Ñ‹Ðµ
- âœ… Ð”ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ Ð¾Ñ‚Ð²ÐµÑ‚Ð¾Ð² OpenAI
- âœ… Fallback-Ð¿Ð°Ñ€ÑÐµÑ€ Ð¿Ð¾ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ð¼ ÑÐ»Ð¾Ð²Ð°Ð¼
- âœ… Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ñ‹ Ð´Ð»Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð¸Ð·Ð²Ð»ÐµÑ‡ÐµÐ½Ð¸Ñ

### 4. Ð‘Ð¾Ñ‚ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ Ð½Ðµ Ð¿Ð¾ Ñ‚ÐµÐ¼Ðµ
- âœ… ÐŸÑ€Ð¾Ð¼Ð¿Ñ‚ Ñ ÑÐ²Ð½Ñ‹Ð¼ Ð·Ð°Ð¿Ñ€ÐµÑ‚Ð¾Ð¼ Ð¿Ð¾ÑÑ‚Ð¾Ñ€Ð¾Ð½Ð½Ð¸Ñ… Ñ‚ÐµÐ¼
- âœ… Ð’ÐµÐ¶Ð»Ð¸Ð²Ñ‹Ð¹ Ð¾Ñ‚ÐºÐ°Ð· + Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚ Ðº Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸

### 5. Ð¡ÐµÑÑÐ¸Ñ Ð½Ðµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÑÐµÑ‚ÑÑ
- âœ… Ð¯Ð²Ð½Ð¾Ðµ ÑÐ¾Ñ…Ñ€Ð°Ð½ÐµÐ½Ð¸Ðµ Ð² Map: `sessions.set(chatId, session)`
- âœ… Ð›Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ñ Ð¿Ð¾ÑÐ»Ðµ ÐºÐ°Ð¶Ð´Ð¾Ð³Ð¾ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ñ

### 6. Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð½Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÑ‚ÑÑ
- âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð¿Ð¾Ð»Ð½Ð¾Ñ‚Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ… Ñ Ð»Ð¾Ð³Ð°Ð¼Ð¸
- âœ… ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾Ðµ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ðµ Ñ‡ÐµÑ€ÐµÐ· API
- âœ… ÐžÑ‡Ð¸ÑÑ‚ÐºÐ° ÐºÐ¾Ð´Ð° Ð¿Ð¾ÑÐ»Ðµ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸

---

## ðŸ“ Ð—Ð°Ñ‚Ñ€Ð¾Ð½ÑƒÑ‚Ñ‹Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ (14 Ñ„Ð°Ð¹Ð»Ð¾Ð²)

### ÐžÑÐ½Ð¾Ð²Ð½Ð°Ñ Ð»Ð¾Ð³Ð¸ÐºÐ° Ð±Ð¾Ñ‚Ð°:
1. `src/lib/telegram-init.ts` â€” +fallback Ð¿Ð°Ñ€ÑÐµÑ€, ÑƒÐ»ÑƒÑ‡ÑˆÐµÐ½Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð¼Ð¿Ñ‚Ñ‹, Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð»Ð¾Ð³Ð¸
2. `src/lib/telegram-init-server.ts` â€” Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð½Ð° Ð²Ñ€ÐµÐ¼Ñ ÑÐ±Ð¾Ñ€ÐºÐ¸
3. `src/lib/bot-launcher.ts` â€” **ÐÐžÐ’Ð«Ð™** Ñ†ÐµÐ½Ñ‚Ñ€Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹ Ð·Ð°Ð¿ÑƒÑÐº
4. `src/app/layout.tsx` â€” Ð¸Ð¼Ð¿Ð¾Ñ€Ñ‚ Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ¾Ð¹

### API ÑÐ½Ð´Ð¿Ð¾Ð¸Ð½Ñ‚Ñ‹:
5. `src/app/api/verification/telegram/start/route.ts` â€” Ð³ÐµÐ½ÐµÑ€Ð°Ñ†Ð¸Ñ UPPERCASE + Ð»Ð¾Ð³Ð¸
6. `src/app/api/verification/telegram/complete/route.ts` â€” Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ + case-insensitive + Ð»Ð¾Ð³Ð¸
7. `src/app/api/health/route.ts` â€” Ð·Ð°Ð¿ÑƒÑÐº Ð±Ð¾Ñ‚Ð° Ñ‡ÐµÑ€ÐµÐ· launchBot()
8. `src/app/api/bot/init/route.ts` â€” **ÐÐžÐ’Ð«Ð™** Ñ€ÑƒÑ‡Ð½Ð°Ñ Ð¸Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ

### UI (Ð±ÐµÐ· Ð¸Ð·Ð¼ÐµÐ½ÐµÐ½Ð¸Ð¹):
9. `src/components/verification/TelegramVerification.tsx`
10. `src/app/auth/signup/customer/page.tsx`
11. `src/app/auth/signup/executor/page.tsx`

### ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ:
12. `env.example` â€” Ð´Ð¾Ð±Ð°Ð²Ð»ÐµÐ½ TELEGRAM_BOT_USERNAME
13. `.env.local` â€” **Ð¡ÐžÐ—Ð”ÐÐ¢Ð¬** Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ

### Ð”Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚Ð°Ñ†Ð¸Ñ:
14. `TELEGRAM_BOT_SETUP.md` â€” **ÐÐžÐ’Ð«Ð™** Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ
15. `TELEGRAM_FIX_SUMMARY.md` â€” **ÐÐžÐ’Ð«Ð™** ÑÑ‚Ð° ÑÐ²Ð¾Ð´ÐºÐ°

---

## ðŸš€ ÐŸÐ¾Ð»Ð½Ð°Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸Ñ Ð¿Ð¾ ÑƒÑÑ‚Ð°Ð½Ð¾Ð²ÐºÐµ

### Ð¨Ð°Ð³ 1: Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ñ„Ð°Ð¹Ð»Ñ‹ Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€

Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚Ðµ Ð²ÑÐµ 13 Ñ„Ð°Ð¹Ð»Ð¾Ð² (Ð¸ÑÐºÐ»ÑŽÑ‡Ð°Ñ .env.local) Ð² `/var/www/mb-trust`

### Ð¨Ð°Ð³ 2: Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ .env.local

```bash
cd /var/www/mb-trust

cat > .env.local <<'EOF'
DATABASE_URL="file:./prisma/dev.db"

NEXTAUTH_SECRET="c7b3f9e2a8d2412fb4f3f2a1e8d97028"
NEXTAUTH_URL="http://109.69.58.185:3000"
AUTH_TRUST_HOST=true

TELEGRAM_BOT_TOKEN="your_telegram_bot_token_here"
TELEGRAM_BOT_USERNAME="MBTRUST_bot"

OPENAI_API_KEY="your_openai_api_key_here"

AUTH_MODE=telegram-only
NEXT_PUBLIC_APP_URL="http://109.69.58.185:3000"
EOF
```

### Ð¨Ð°Ð³ 3: ÐŸÐµÑ€ÐµÑÐ¾Ð±Ñ€Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚

```bash
npm ci
npx prisma generate
npm run build
```

### Ð¨Ð°Ð³ 4: Ð˜ÑÐ¿Ñ€Ð°Ð²Ð¸Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°

```bash
sudo chown -R www-data:www-data .next
sudo chmod -R 755 .next
```

### Ð¨Ð°Ð³ 5: ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ ÑÐµÑ€Ð²Ð¸Ñ

```bash
sudo systemctl restart mb-trust
```

### Ð¨Ð°Ð³ 6: Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒ Ð±Ð¾Ñ‚Ð° (Ð²Ñ‹Ð·Ð²Ð°Ñ‚ÑŒ health check)

```bash
sleep 3
curl http://localhost:3000/api/health
```

### Ð¨Ð°Ð³ 7: ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸

```bash
journalctl -u mb-trust -n 100 | grep -E "Telegram|ðŸ¤–|BOT"
```

**Ð”Ð¾Ð»Ð¶Ð½Ñ‹ ÑƒÐ²Ð¸Ð´ÐµÑ‚ÑŒ:**
- `ðŸ¤– Ð—Ð°Ð¿ÑƒÑÐº Telegram Ð±Ð¾Ñ‚Ð°...`
- `âœ… Telegram Ð±Ð¾Ñ‚ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½`

---

## ðŸ§ª Ð¢ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ

### 1. ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ð±Ð¾Ñ‚ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚

ÐžÑ‚Ð¿Ñ€Ð°Ð²ÑŒÑ‚Ðµ Ð² Ð±Ð¾Ñ‚Ðµ: `/start`

Ð”Ð¾Ð»Ð¶ÐµÐ½ Ð¾Ñ‚Ð²ÐµÑ‚Ð¸Ñ‚ÑŒ Ñ Ð¸Ð½ÑÑ‚Ñ€ÑƒÐºÑ†Ð¸ÑÐ¼Ð¸.

### 2. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±Ð¾Ð²Ð°Ñ‚ÑŒ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸ÑŽ

1. ÐžÑ‚ÐºÑ€Ð¾Ð¹Ñ‚Ðµ http://109.69.58.185:3000/auth/signup/customer
2. Ð—Ð°Ð¿Ð¾Ð»Ð½Ð¸Ñ‚Ðµ Ñ„Ð¾Ñ€Ð¼Ñƒ
3. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ "Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð°ÐºÐºÐ°ÑƒÐ½Ñ‚"
4. ÐÐ°Ð¶Ð¼Ð¸Ñ‚Ðµ "ÐÐ°Ñ‡Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¸Ð²ÑÐ·ÐºÑƒ Ñ‡ÐµÑ€ÐµÐ· Telegram"
5. Ð¡ÐºÐ¾Ð¿Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ ÐºÐ¾Ð´ Ð¸Ð»Ð¸ Ð½Ð°Ð¶Ð¼Ð¸Ñ‚Ðµ "ÐžÑ‚ÐºÑ€Ñ‹Ñ‚ÑŒ Telegram Ð±Ð¾Ñ‚Ð°"
6. Ð’ Ð±Ð¾Ñ‚Ðµ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð½Ð°Ñ‡Ð°Ñ‚ÑŒÑÑ Ð´Ð¸Ð°Ð»Ð¾Ð³

### 3. ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸ Ð²Ð¾ Ð²Ñ€ÐµÐ¼Ñ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸

```bash
journalctl -u mb-trust -f
```

**Ð”Ð¾Ð»Ð¶Ð½Ñ‹ Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑŒÑÑ ÑÑ‚Ñ€Ð¾ÐºÐ¸:**
- `[VERIFY-START] Ð—Ð°Ð¿ÑƒÑÐº Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸...`
- `[VERIFY-START] Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½ ÐºÐ¾Ð´: XXXXXX`
- `[VERIFY] ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð´Ð°: ...`
- `[BOT] ÐšÐ¾Ð´ ... Ð¿Ñ€Ð¸Ð½ÑÑ‚`
- `[AI] OpenAI extraction response: ...`
- `[BOT] ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ ...`
- `[BOT] Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ: {...}`
- `[BOT] Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»Ð½Ñ‹Ðµ? true`
- `[BOT] Ð—Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÐ¼ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸ÑŽ...`
- `[BOT] Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸...`

### 4. Ð•ÑÐ»Ð¸ OpenAI Ð½Ðµ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚

Ð’ Ð»Ð¾Ð³Ð°Ñ… Ð±ÑƒÐ´ÐµÑ‚:
- `[AI] Fallback extracted: {...}`

Fallback-Ð¿Ð°Ñ€ÑÐµÑ€ Ñ€Ð°Ð±Ð¾Ñ‚Ð°ÐµÑ‚ Ð¿Ð¾ ÐºÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ð¼ ÑÐ»Ð¾Ð²Ð°Ð¼, Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð¾Ñ‚Ð²ÐµÑ‡Ð°Ð¹Ñ‚Ðµ Ñ‡Ñ‘Ñ‚ÐºÐ¾:
- "Ð¯ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº"
- "VK" Ð¸Ð»Ð¸ "Telegram"
- "ÐœÐ¾ÑÐºÐ²Ð°"
- "1000" (Ñ‡Ð¸ÑÐ»Ð¾ Ð¿Ð¾Ð´Ð¿Ð¸ÑÑ‡Ð¸ÐºÐ¾Ð²)
- "Ð´Ð°" Ð¸Ð»Ð¸ "Ð½ÐµÑ‚" (ÐµÐ¶ÐµÐ´Ð½ÐµÐ²Ð½Ñ‹Ðµ Ð·Ð°Ð´Ð°Ð½Ð¸Ñ)
- "Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²" (Ð¸Ð¼Ñ Ð¸ Ñ„Ð°Ð¼Ð¸Ð»Ð¸Ñ)

---

## ðŸ” Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ ÐºÐ¾Ð¼Ð°Ð½Ð´Ñ‹

```bash
# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ
systemctl show mb-trust | grep EnvironmentFile
cat .env.local | grep TELEGRAM

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ, Ñ‡Ñ‚Ð¾ Ð±Ð¾Ñ‚ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½
journalctl -u mb-trust | grep "Telegram Ð±Ð¾Ñ‚ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½"

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÐºÐ¾Ð´Ñ‹ Ð² Ð‘Ð”
sqlite3 prisma/dev.db "SELECT id, name, verificationCode, isVerified, telegramId FROM users ORDER BY createdAt DESC LIMIT 5;"

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ ÑÑ‚Ð°Ñ‚ÑƒÑ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ
curl "http://localhost:3000/api/users?userId=USER_ID_HERE"

# Ð’Ñ‹Ð·Ð²Ð°Ñ‚ÑŒ health check Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ
curl http://localhost:3000/api/health

# ÐŸÑ€Ð¾Ð²ÐµÑ€Ð¸Ñ‚ÑŒ Ð»Ð¾Ð³Ð¸ Ð² Ñ€ÐµÐ°Ð»ÑŒÐ½Ð¾Ð¼ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
journalctl -u mb-trust -f | grep -E "\[BOT\]|\[VERIFY\]|\[AI\]"
```

---

## ðŸ“Š ÐžÐ¶Ð¸Ð´Ð°ÐµÐ¼Ñ‹Ð¹ Ð»Ð¾Ð³ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾Ð¹ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸

```
[VERIFY-START] Ð—Ð°Ð¿ÑƒÑÐº Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ clxxx123
[VERIFY-START] Ð¡Ð³ÐµÐ½ÐµÑ€Ð¸Ñ€Ð¾Ð²Ð°Ð½ ÐºÐ¾Ð´: A1B2C3
[VERIFY-START] ÐšÐ¾Ð´ ÑÐ¾Ñ…Ñ€Ð°Ð½Ñ‘Ð½ Ð² Ð‘Ð”
[BOT] ÐšÐ¾Ð´ A1B2C3 Ð¿Ñ€Ð¸Ð½ÑÑ‚, Ð½Ð°Ñ‡Ð¸Ð½Ð°ÐµÐ¼ Ð´Ð¸Ð°Ð»Ð¾Ð³ Ð´Ð»Ñ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»Ñ 7180687130
[AI] OpenAI conversation response: ...
[BOT] ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ 7180687130: {"messenger":"VK"}
[BOT] Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ: {"messenger":"VK"}
[AI] OpenAI extraction response: ...
[BOT] ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ 7180687130: {"name":"Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²"}
[BOT] Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ: {"messenger":"VK","name":"Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²"}
[BOT] ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ 7180687130: {"city":"ÐœÐ¾ÑÐºÐ²Ð°"}
[BOT] Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ: {"messenger":"VK","name":"Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²","city":"ÐœÐ¾ÑÐºÐ²Ð°"}
[BOT] ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ 7180687130: {"followers":1000}
[BOT] Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ: {"messenger":"VK","name":"Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²","city":"ÐœÐ¾ÑÐºÐ²Ð°","followers":1000}
[BOT] ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ 7180687130: {"real":"yes"}
[BOT] Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ: {"messenger":"VK","name":"Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²","city":"ÐœÐ¾ÑÐºÐ²Ð°","followers":1000,"real":"yes"}
[BOT] ÐžÐ±Ð½Ð¾Ð²Ð»ÐµÐ½Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ 7180687130: {"daily":true}
[BOT] Ð¢ÐµÐºÑƒÑ‰ÐµÐµ ÑÐ¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ: {"messenger":"VK","name":"Ð˜Ð²Ð°Ð½ Ð˜Ð²Ð°Ð½Ð¾Ð²","city":"ÐœÐ¾ÑÐºÐ²Ð°","followers":1000,"real":"yes","daily":true}
[BOT] Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾Ð»Ð½Ñ‹Ðµ Ð´Ð»Ñ 7180687130? true
[BOT] Ð—Ð°Ð²ÐµÑ€ÑˆÐ°ÐµÐ¼ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸ÑŽ Ð´Ð»Ñ 7180687130 Ñ ÐºÐ¾Ð´Ð¾Ð¼ A1B2C3
[VERIFY] ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ð´Ð°: Ð¸ÑÑ…Ð¾Ð´Ð½Ñ‹Ð¹="A1B2C3", Ð½Ð¾Ñ€Ð¼Ð°Ð»Ð¸Ð·Ð¾Ð²Ð°Ð½Ð½Ñ‹Ð¹="A1B2C3"
[VERIFY] Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð¿Ð¾Ð¸ÑÐºÐ°: Ð½Ð°Ð¹Ð´ÐµÐ½ Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ clxxx123
[BOT] Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð²ÐµÑ€Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸: {"success":true}
```

---

## âš ï¸ Ð’Ð°Ð¶Ð½Ð¾

- ÐŸÐ¾ÑÐ»Ðµ Ð¿ÐµÑ€ÐµÑÐ±Ð¾Ñ€ÐºÐ¸ Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ Ð²Ñ‹Ð·Ð¾Ð²Ð¸Ñ‚Ðµ `curl http://localhost:3000/api/health` Ð´Ð»Ñ Ð·Ð°Ð¿ÑƒÑÐºÐ° Ð±Ð¾Ñ‚Ð°
- Ð•ÑÐ»Ð¸ OpenAI Ð½Ðµ Ð¾Ñ‚Ð²ÐµÑ‡Ð°ÐµÑ‚ Ð¸Ð»Ð¸ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‰Ð°ÐµÑ‚ Ð¿ÑƒÑÑ‚Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ â€” fallback-Ð¿Ð°Ñ€ÑÐµÑ€ Ð¿Ð¾Ð´Ñ…Ð²Ð°Ñ‚Ð¸Ñ‚
- Ð’ÑÐµ Ð»Ð¾Ð³Ð¸ Ñ Ð¿Ñ€ÐµÑ„Ð¸ÐºÑÐ°Ð¼Ð¸ `[BOT]`, `[VERIFY]`, `[AI]` Ð¿Ð¾Ð¼Ð¾Ð³ÑƒÑ‚ Ð½Ð°Ð¹Ñ‚Ð¸ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ñƒ
- Ð“ÐµÐ½ÐµÑ€Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹ ÐºÐ¾Ð´ Ð´Ð»Ñ ÐºÐ°Ð¶Ð´Ð¾Ð¹ Ð¿Ð¾Ð¿Ñ‹Ñ‚ÐºÐ¸ Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸

