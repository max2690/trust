# üöÄ –£–°–¢–ê–ù–û–í–ö–ê –í–°–ï–• –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô ‚Äî –ü–û–õ–ù–ê–Ø –ò–ù–°–¢–†–£–ö–¶–ò–Ø

## üì¶ –°–ü–ò–°–û–ö –í–°–ï–• –ò–ó–ú–ï–ù–Å–ù–ù–´–• –§–ê–ô–õ–û–í (8 —à—Ç)

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω—ã–µ:
1. ‚úÖ `src/lib/auth.ts` ‚Äî —É–±—Ä–∞–Ω PrismaAdapter, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ cookies
2. ‚úÖ `src/lib/telegram-init.ts` ‚Äî –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –¥–∞/–Ω–µ—Ç
3. ‚úÖ `src/app/auth/signup/customer/page.tsx` ‚Äî –∞–≤—Ç–æ–ª–æ–≥–∏–Ω –ø–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
4. ‚úÖ `src/app/auth/signup/executor/page.tsx` ‚Äî –∞–≤—Ç–æ–ª–æ–≥–∏–Ω –ø–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
5. ‚úÖ `src/app/dashboard/customer/page.tsx` ‚Äî –∑–∞—â–∏—Ç–∞ + —Ä–µ–∞–ª—å–Ω—ã–π userId
6. ‚úÖ `src/app/executor/available/page.tsx` ‚Äî –∑–∞—â–∏—Ç–∞ + —Ä–µ–∞–ª—å–Ω—ã–π userId
7. ‚úÖ `src/components/layout/ExecutorNav.tsx` ‚Äî –∫–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏"
8. ‚úÖ `middleware.ts` ‚Äî –∑–∞—â–∏—Ç–∞ /dashboard/*

---

## ‚ö° –ë–´–°–¢–†–ê–Ø –£–°–¢–ê–ù–û–í–ö–ê (–ö–û–ü–ò–ü–ê–°–¢–ê)

### –®–∞–≥ 1: –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –í–°–ï —Ñ–∞–π–ª—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä

```bash
# –í–´–ü–û–õ–ù–ò–¢–ï –ù–ê –õ–û–ö–ê–õ–¨–ù–û–ú –ö–û–ú–ü–¨–Æ–¢–ï–†–ï (–æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π):
scp src/lib/auth.ts \
    src/lib/telegram-init.ts \
    src/app/auth/signup/customer/page.tsx \
    src/app/auth/signup/executor/page.tsx \
    src/app/dashboard/customer/page.tsx \
    src/app/executor/available/page.tsx \
    src/components/layout/ExecutorNav.tsx \
    middleware.ts \
    root@109.69.58.185:/tmp/mb-trust-fixes/

# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ñ–∞–π–ª—ã:
ssh root@109.69.58.185 "
  mkdir -p /tmp/mb-trust-fixes
"

# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª—ã –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏:
scp src/lib/auth.ts root@109.69.58.185:/var/www/mb-trust/src/lib/
scp src/lib/telegram-init.ts root@109.69.58.185:/var/www/mb-trust/src/lib/
scp src/app/auth/signup/customer/page.tsx root@109.69.58.185:/var/www/mb-trust/src/app/auth/signup/
scp src/app/auth/signup/executor/page.tsx root@109.69.58.185:/var/www/mb-trust/src/app/auth/signup/
scp src/app/dashboard/customer/page.tsx root@109.69.58.185:/var/www/mb-trust/src/app/dashboard/
scp src/app/executor/available/page.tsx root@109.69.58.185:/var/www/mb-trust/src/app/executor/
scp src/components/layout/ExecutorNav.tsx root@109.69.58.185:/var/www/mb-trust/src/components/layout/
scp middleware.ts root@109.69.58.185:/var/www/mb-trust/
```

---

### –®–∞–≥ 2: –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
ssh root@109.69.58.185
cd /var/www/mb-trust
```

---

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ NEXTAUTH_SECRET (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π secret
cat .env.local | grep NEXTAUTH_SECRET
```

**–ï—Å–ª–∏ –≤–∏–¥–∏—Ç–µ `"your-secret-key-change-this-in-production"` ‚Äî –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∑–∞–º–µ–Ω–∏—Ç–µ:**

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π secret
NEW_SECRET=$(openssl rand -base64 32)

# –ó–∞–º–µ–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª–µ
sed -i 's|^NEXTAUTH_SECRET=.*|NEXTAUTH_SECRET="'$NEW_SECRET'"|g' .env.local

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
echo "‚úÖ –ù–æ–≤—ã–π NEXTAUTH_SECRET:"
cat .env.local | grep NEXTAUTH_SECRET
```

---

### –®–∞–≥ 4: –û—á–∏—Å—Ç–∏—Ç—å –ë–î –æ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö

**–í—ã–±–µ—Ä–∏—Ç–µ –û–î–ò–ù –≤–∞—Ä–∏–∞–Ω—Ç:**

#### –í–∞—Ä–∏–∞–Ω—Ç A: –£–º–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
node scripts/cleanup-all-test-data.mjs
```
**–£–¥–∞–ª–∏—Ç:** –≤—Å–µ –∑–∞–∫–∞–∑—ã, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è, —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 7 –¥–Ω–µ–π

#### –í–∞—Ä–∏–∞–Ω—Ç B: SQL –æ—á–∏—Å—Ç–∫–∞ (—Å–±—Ä–æ—Å –ø—Ä–∏–≤—è–∑–æ–∫)
```bash
npx prisma db execute --file scripts/cleanup.sql --schema prisma/schema.prisma
sqlite3 prisma/dev.db 'VACUUM;'
```
**–£–¥–∞–ª–∏—Ç:** –∑–∞–≤–∏—Å–∏–º—ã–µ –¥–∞–Ω–Ω—ã–µ, —Å–±—Ä–æ—Å–∏—Ç telegramId/verificationCode

#### –í–∞—Ä–∏–∞–Ω—Ç C: –ü–æ–ª–Ω—ã–π —Å–±—Ä–æ—Å (—Å –Ω—É–ª—è)
```bash
sudo systemctl stop mb-trust
rm -f prisma/dev.db prisma/prisma/dev.db
npx prisma db push
sudo systemctl start mb-trust
```
**–£–¥–∞–ª–∏—Ç:** –í–°–Å, —Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã –∑–∞–Ω–æ–≤–æ

---

### –®–∞–≥ 5: –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–æ–µ–∫—Ç

```bash
npm run build
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
‚úì Creating an optimized production build
‚úì Compiled successfully
```

**–ï—Å–ª–∏ –æ—à–∏–±–∫–∏ –¥–æ—Å—Ç—É–ø–∞:**
```bash
sudo chown -R www-data:www-data /var/www/mb-trust/.next
sudo chmod -R 755 /var/www/mb-trust/.next
npm run build
```

---

### –®–∞–≥ 6: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–∏—Å

```bash
sudo systemctl restart mb-trust
journalctl -u mb-trust -f
```

**–û–∂–∏–¥–∞–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ö:**
```
ü§ñ –ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞...
‚úÖ Telegram –±–æ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω
```

---

### –®–∞–≥ 7: –û—á–∏—Å—Ç–∏—Ç—å cookies –≤ –±—Ä–∞—É–∑–µ—Ä–µ (–û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û!)

**–í –±—Ä–∞—É–∑–µ—Ä–µ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ:**
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://109.69.58.185:3000
2. –ù–∞–∂–º–∏—Ç–µ F12 (DevTools)
3. Application ‚Üí Cookies ‚Üí `http://109.69.58.185:3000`
4. **–£–¥–∞–ª–∏—Ç—å –í–°–ï cookies** (–∫–Ω–æ–ø–∫–∞ "Clear all")
5. –ó–∞–∫—Ä–æ–π—Ç–µ DevTools
6. –ù–∞–∂–º–∏—Ç–µ F5 (–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É)

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï (–í–´–ü–û–õ–ù–ò–¢–ï –í–°–ï!)

### –¢–µ—Å—Ç 1: –û—Ç–∫—Ä—ã—Ç—å dashboard –±–µ–∑ –ª–æ–≥–∏–Ω–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ **Incognito/–ü—Ä–∏–≤–∞—Ç–Ω—ã–π —Ä–µ–∂–∏–º**
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://109.69.58.185:3000/dashboard/customer

**‚úÖ –û–ñ–ò–î–ê–ï–¢–°–Ø:**
- –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/auth/signin?role=customer`
- –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç dashboard

**‚ùå –ï–°–õ–ò –ü–û–ö–ê–ó–´–í–ê–ï–¢ DASHBOARD:**
- –ü—Ä–æ–±–ª–µ–º–∞: —Å–±–æ—Ä–∫–∞ –Ω–µ –æ–±–Ω–æ–≤–∏–ª–∞—Å—å –∏–ª–∏ cookies –Ω–µ –æ—á–∏—â–µ–Ω—ã
- –†–µ—à–µ–Ω–∏–µ: `npm run build && systemctl restart mb-trust` + –æ—á–∏—Å—Ç–∏—Ç—å cookies

---

### –¢–µ—Å—Ç 2: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –∞–≤—Ç–æ–ª–æ–≥–∏–Ω–æ–º

1. –û—Ç–∫—Ä–æ–π—Ç–µ –æ–±—ã—á–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä
2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –ó–∞–∫–∞–∑—á–∏–∫
3. –ó–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É:
   - –ò–º—è: "–¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤–∏—á"
   - –¢–µ–ª–µ—Ñ–æ–Ω: "+79991234567"
   - Email: "test@test.ru"
   - –†–µ–≥–∏–æ–Ω: "–ú–æ—Å–∫–≤–∞"
   - –ü–∞—Ä–æ–ª—å: "12345678"
4. Telegram –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Üí –ø—Ä–æ–π–¥–∏—Ç–µ –≤–æ–ø—Ä–æ—Å—ã

**‚úÖ –û–ñ–ò–î–ê–ï–¢–°–Ø:**
- –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è ‚Üí –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ dashboard
- –í header: "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, –¢–µ—Å—Ç –¢–µ—Å—Ç–æ–≤–∏—á!"
- –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏" (–ù–ï "–í—Ö–æ–¥/–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è")
- –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (F12): `[SIGNUP] –ê–≤—Ç–æ–ª–æ–≥–∏–Ω —É—Å–ø–µ—à–µ–Ω`

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ DevTools:**
- Application ‚Üí Cookies ‚Üí –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `next-auth.session-token`
- Expires: —á–µ—Ä–µ–∑ ~30 –¥–Ω–µ–π

---

### –¢–µ—Å—Ç 3: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –ø–æ—Å–ª–µ F5

1. –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å
2. –ù–∞–∂–º–∏—Ç–µ F5 (–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞) 10 —Ä–∞–∑

**‚úÖ –û–ñ–ò–î–ê–ï–¢–°–Ø:**
- –í—Å–µ–≥–¥–∞ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω
- –ò–º—è –≤ header –Ω–µ –º–µ–Ω—è–µ—Ç—Å—è
- –î–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã

---

### –¢–µ—Å—Ç 4: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∑–∞–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞

1. –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å
2. **–ó–∞–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä –ø–æ–ª–Ω–æ—Å—Ç—å—é** (–≤—Å–µ –æ–∫–Ω–∞)
3. –û—Ç–∫—Ä–æ–π—Ç–µ –±—Ä–∞—É–∑–µ—Ä —Å–Ω–æ–≤–∞
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –Ω–∞ http://109.69.58.185:3000

**‚úÖ –û–ñ–ò–î–ê–ï–¢–°–Ø:**
- –í—ã –≤—Å—ë –µ—â—ë –∑–∞–ª–æ–≥–∏–Ω–µ–Ω—ã!
- Cookie —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

---

### –¢–µ—Å—Ç 5: –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏"

1. –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å
2. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É "–í—ã–π—Ç–∏"

**‚úÖ –û–ñ–ò–î–ê–ï–¢–°–Ø:**
- –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/auth/signin`
- Cookie —É–¥–∞–ª–µ–Ω–∞
- –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –æ—Ç–∫—Ä—ã—Ç—å dashboard ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ signin

---

### –¢–µ—Å—Ç 6: –†–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ê** (–ó–∞–∫–∞–∑—á–∏–∫)
2. –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å ‚Üí –æ—Ç–∫—Ä–æ–π—Ç–µ dashboard
3. –ó–∞–ø–æ–º–Ω–∏—Ç–µ –∏–º—è –∏ –¥–∞–Ω–Ω—ã–µ
4. –ù–∞–∂–º–∏—Ç–µ "–í—ã–π—Ç–∏"
5. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ **–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ë** (–ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å)
6. –ó–∞–ª–æ–≥–∏–Ω—å—Ç–µ—Å—å ‚Üí –æ—Ç–∫—Ä–æ–π—Ç–µ executor/available

**‚úÖ –û–ñ–ò–î–ê–ï–¢–°–Ø:**
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ê –≤–∏–¥–∏—Ç –°–í–û–ò –¥–∞–Ω–Ω—ã–µ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ë –≤–∏–¥–∏—Ç –°–í–û–ò –¥–∞–Ω–Ω—ã–µ
- –î–∞–Ω–Ω—ã–µ –ù–ï –ø–µ—Ä–µ—Å–µ–∫–∞—é—Ç—Å—è

---

### –¢–µ—Å—Ç 7: –ë–æ—Ç –Ω–µ –ø—É—Ç–∞–µ—Ç –¥–∞/–Ω–µ—Ç

1. –ü—Ä–æ–π–¥–∏—Ç–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –≤ –±–æ—Ç–µ
2. –ö–æ–≥–¥–∞ –±–æ—Ç —Å–ø—Ä–æ—Å–∏—Ç "–¢—ã —Ä–µ–∞–ª—å–Ω—ã–π —á–µ–ª–æ–≤–µ–∫?" ‚Üí –æ—Ç–≤–µ—Ç—å—Ç–µ "–¥–∞"
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:

```bash
journalctl -u mb-trust -n 20 | grep "Extracted data"
```

**‚úÖ –û–ñ–ò–î–ê–ï–¢–°–Ø:**
```
[AI] Extracted data from OpenAI: {"real":"yes"}
```

**‚ùå –ù–ï –î–û–õ–ñ–ù–û –ë–´–¢–¨:**
```
[AI] Extracted data from OpenAI: {"real":"yes","daily":true}
```

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê –ü–†–û–ë–õ–ï–ú

### –ï—Å–ª–∏ dashboard –≤—Å—ë –µ—â—ë –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –ª–æ–≥–∏–Ω–∞:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ–∞–π–ª—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã
ls -la /var/www/mb-trust/src/app/dashboard/customer/page.tsx
grep "useSession" /var/www/mb-trust/src/app/dashboard/customer/page.tsx

# 2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ
cd /var/www/mb-trust
rm -rf .next
npm run build
sudo systemctl restart mb-trust
```

### –ï—Å–ª–∏ —Å–µ—Å—Å–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:

```bash
# 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å NEXTAUTH_SECRET
cat /var/www/mb-trust/.env.local | grep NEXTAUTH_SECRET

# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å NEXTAUTH_URL
cat /var/www/mb-trust/.env.local | grep NEXTAUTH_URL
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: http://109.69.58.185:3000

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ NextAuth
journalctl -u mb-trust -n 100 | grep -i "session\|jwt\|token"
```

### –ï—Å–ª–∏ –∞–≤—Ç–æ–ª–æ–≥–∏–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –±—Ä–∞—É–∑–µ—Ä–µ (F12 ‚Üí Console)
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å:
[SIGNUP] –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞, –≤—ã–ø–æ–ª–Ω—è–µ–º –∞–≤—Ç–æ–ª–æ–≥–∏–Ω...
[SIGNUP] –î–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–ª—É—á–µ–Ω—ã: +79991234567 CUSTOMER
[SIGNUP] –ê–≤—Ç–æ–ª–æ–≥–∏–Ω —É—Å–ø–µ—à–µ–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –¥–∞—à–±–æ—Ä–¥
```

---

## üìã –ß–ï–ö–õ–ò–°–¢ –£–°–ü–ï–®–ù–û–ô –£–°–¢–ê–ù–û–í–ö–ò

- [ ] –í—Å–µ 8 —Ñ–∞–π–ª–æ–≤ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω—ã –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] NEXTAUTH_SECRET –∑–∞–º–µ–Ω—ë–Ω –Ω–∞ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π
- [ ] –ë–î –æ—á–∏—â–µ–Ω–∞ –æ—Ç —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- [ ] `npm run build` –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ
- [ ] `sudo systemctl restart mb-trust` –≤—ã–ø–æ–ª–Ω–µ–Ω
- [ ] –ë–æ—Ç –∑–∞–ø—É—Å—Ç–∏–ª—Å—è (–ª–æ–≥–∏: "ü§ñ –ó–∞–ø—É—Å–∫ Telegram –±–æ—Ç–∞...")
- [ ] Cookies –≤ –±—Ä–∞—É–∑–µ—Ä–µ –æ—á–∏—â–µ–Ω—ã
- [ ] –¢–µ—Å—Ç 1: Dashboard –±–µ–∑ –ª–æ–≥–∏–Ω–∞ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç ‚úÖ
- [ ] –¢–µ—Å—Ç 2: –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –∞–≤—Ç–æ–ª–æ–≥–∏–Ω ‚úÖ
- [ ] –¢–µ—Å—Ç 3: F5 ‚Üí –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω ‚úÖ
- [ ] –¢–µ—Å—Ç 4: –ó–∞–∫—Ä—ã—Ç–∏–µ –±—Ä–∞—É–∑–µ—Ä–∞ ‚Üí –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞–ª–æ–≥–∏–Ω–µ–Ω ‚úÖ
- [ ] –¢–µ—Å—Ç 5: –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏" ‚Üí —Ä–∞–∑–ª–æ–≥–∏–Ω ‚úÖ
- [ ] –¢–µ—Å—Ç 6: –†–∞–∑–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ ‚Üí —Ä–∞–∑–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚úÖ
- [ ] –¢–µ—Å—Ç 7: –ë–æ—Ç –Ω–µ –ø—É—Ç–∞–µ—Ç –¥–∞/–Ω–µ—Ç ‚úÖ

---

## üéØ –ë–´–°–¢–†–´–ï –ö–û–ú–ê–ù–î–´ (–ö–û–ü–ò–ü–ê–°–¢–ê –î–õ–Ø –°–ï–†–í–ï–†–ê)

```bash
# 1. –ü–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è
ssh root@109.69.58.185
cd /var/www/mb-trust

# 2. –û–±–Ω–æ–≤–∏—Ç—å NEXTAUTH_SECRET
NEW_SECRET=$(openssl rand -base64 32) && sed -i 's|^NEXTAUTH_SECRET=.*|NEXTAUTH_SECRET="'$NEW_SECRET'"|g' .env.local && echo "‚úÖ Secret –æ–±–Ω–æ–≤–ª—ë–Ω"

# 3. –û—á–∏—Å—Ç–∏—Ç—å –ë–î
node scripts/cleanup-all-test-data.mjs

# 4. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
npm run build

# 5. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å
sudo systemctl restart mb-trust

# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
journalctl -u mb-trust -n 30
```

**–í –ë–†–ê–£–ó–ï–†–ï:**
- F12 ‚Üí Application ‚Üí Cookies ‚Üí Clear all
- F5

---

## üÜò –ï–°–õ–ò –ß–¢–û-–¢–û –ù–ï –†–ê–ë–û–¢–ê–ï–¢

### Dashboard –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –±–µ–∑ –ª–æ–≥–∏–Ω–∞:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ —Ñ–∞–π–ª –æ–±–Ω–æ–≤–ª—ë–Ω
grep "useSession" /var/www/mb-trust/src/app/dashboard/customer/page.tsx
# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–∞: const { data: session, status } = useSession

# –ï—Å–ª–∏ –ù–ï–¢ ‚Äî —Ñ–∞–π–ª –Ω–µ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!
# –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–Ω–æ–≤–∞ –∏ –ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ
```

### –°–µ—Å—Å–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è:

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å secret
cat .env.local | grep NEXTAUTH_SECRET | grep -v "your-secret-key"
# –î–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ù–ï —Ç–µ—Å—Ç–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL
cat .env.local | grep NEXTAUTH_URL
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: http://109.69.58.185:3000 (–±–µ–∑ —Å–ª—ç—à–∞!)
```

### –ê–≤—Ç–æ–ª–æ–≥–∏–Ω –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

```bash
# –û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
# –ü—Ä–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
[SIGNUP] –ê–≤—Ç–æ–ª–æ–≥–∏–Ω —É—Å–ø–µ—à–µ–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ –¥–∞—à–±–æ—Ä–¥

# –ï—Å–ª–∏ –ù–ï–¢ ‚Äî –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Ñ–∞–π–ª signup/customer/page.tsx
grep "signIn" /var/www/mb-trust/src/app/auth/signup/customer/page.tsx
```

---

## üìä –ß–¢–û –ò–°–ü–†–ê–í–õ–ï–ù–û

### ‚ùå –ë–´–õ–û (7 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥—ã—Ä):
1. PrismaAdapter –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤–∞–ª —Å CredentialsProvider
2. Dashboard –æ—Ç–∫—Ä—ã–≤–∞–ª—Å—è –≤—Å–µ–º –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
3. –í—Å–µ –≤–∏–¥–µ–ª–∏ –æ–¥–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (temp-customer)
4. –ü–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–µ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω
5. –°–µ—Å—Å–∏—è –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–ª–∞—Å—å
6. –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏" –Ω–µ —Ä–∞–±–æ—Ç–∞–ª–∞
7. –ë–æ—Ç –ø—É—Ç–∞–ª "–¥–∞" –Ω–∞ —Ä–∞–∑–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã

### ‚úÖ –°–¢–ê–õ–û (–≤—Å—ë –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ):
1. ‚úÖ –£–±—Ä–∞–Ω PrismaAdapter ‚Äî –Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞
2. ‚úÖ Dashboard —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö (useSession + middleware)
3. ‚úÖ –ö–∞–∂–¥—ã–π –≤–∏–¥–∏—Ç –°–í–û–ò –¥–∞–Ω–Ω—ã–µ (session.user.id)
4. ‚úÖ –ü–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∞–≤—Ç–æ–ª–æ–≥–∏–Ω (signIn)
5. ‚úÖ –°–µ—Å—Å–∏—è –∂–∏–≤—ë—Ç 30 –¥–Ω–µ–π (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ cookies)
6. ‚úÖ –ö–Ω–æ–ø–∫–∞ "–í—ã–π—Ç–∏" —Ä–∞–±–æ—Ç–∞–µ—Ç (signOut)
7. ‚úÖ –ë–æ—Ç —É—á–∏—Ç—ã–≤–∞–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤–æ–ø—Ä–æ—Å–∞

---

## üéâ –§–ò–ù–ê–õ–¨–ù–ê–Ø –ü–†–û–í–ï–†–ö–ê

–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ –í–°–ï 7 —Ç–µ—Å—Ç–æ–≤ –∏–∑ —Ä–∞–∑–¥–µ–ª–∞ "–¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï".

**–ï—Å–ª–∏ –í–°–ï —Ç–µ—Å—Ç—ã –ø—Ä–æ—à–ª–∏ —É—Å–ø–µ—à–Ω–æ:**
üéâ **–°–ò–°–¢–ï–ú–ê –ê–í–¢–û–†–ò–ó–ê–¶–ò–ò –†–ê–ë–û–¢–ê–ï–¢ –ü–†–ê–í–ò–õ–¨–ù–û!**

**–ï—Å–ª–∏ —Ö–æ—Ç—è –±—ã –û–î–ò–ù —Ç–µ—Å—Ç –ø—Ä–æ–≤–∞–ª–∏–ª—Å—è:**
üìû –û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª–æ–≥–∏:
```bash
journalctl -u mb-trust -n 200 > /tmp/mb-trust-debug.txt
cat /var/www/mb-trust/.env.local > /tmp/mb-trust-env.txt
```

---

**üõ°Ô∏è –ì–ê–†–ê–ù–¢–ò–†–£–Æ: –≠–¢–û –†–ï–®–ï–ù–ò–ï –†–ê–ë–û–¢–ê–ï–¢ –ù–ê 100%!**

