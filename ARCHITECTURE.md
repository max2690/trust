# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ MB-TRUST

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ

1. [–û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞](#–æ–±–∑–æ—Ä-–ø—Ä–æ–µ–∫—Ç–∞)
2. [–¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫](#—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π-—Å—Ç–µ–∫)
3. [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
4. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–ª–æ–∏](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ-—Å–ª–æ–∏)
5. [–û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö](#–æ—Å–Ω–æ–≤–Ω—ã–µ-–ø–æ—Ç–æ–∫–∏-–¥–∞–Ω–Ω—ã—Ö)
6. [–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö](#–±–∞–∑–∞-–¥–∞–Ω–Ω—ã—Ö)
7. [API Endpoints](#api-endpoints)
8. [–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã](#–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã-–∏-—Å–µ—Ä–≤–∏—Å—ã)
9. [–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è](#–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å-–∏-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è)
10. [–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏](#–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏)

---

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞

**MB-TRUST** ‚Äî –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞ –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è —Ä–µ–∫–ª–∞–º–Ω—ã—Ö –∑–∞–¥–∞–Ω–∏–π –≤ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö. –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ —Å–≤—è–∑—ã–≤–∞–µ—Ç –∑–∞–∫–∞–∑—á–∏–∫–æ–≤ (CUSTOMER) –∏ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π (EXECUTOR), –æ–±–µ—Å–ø–µ—á–∏–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏, –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–ø–ª–∞—Ç—ã.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:
- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–∫–ª–∞–º–Ω—ã–º–∏ –∑–∞–¥–∞–Ω–∏—è–º–∏
- –ì–µ–æ—Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥ –∑–∞–¥–∞–Ω–∏–π
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–Ω—à–æ—Ç—ã
- –°–∏—Å—Ç–µ–º–∞ —É—Ä–æ–≤–Ω–µ–π –¥–æ–≤–µ—Ä–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã–ø–ª–∞—Ç—ã —á–µ—Ä–µ–∑ Telegram Wallet –∏ –°–ë–ü
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞—è –ø–∞–Ω–µ–ª—å –¥–ª—è –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- Telegram-–±–æ—Ç –¥–ª—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

### Frontend
- **Next.js 15.5.6** ‚Äî React-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫ —Å App Router
- **React 19.1.0** ‚Äî UI –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
- **TypeScript** ‚Äî —Ç–∏–ø–∏–∑–∞—Ü–∏—è
- **Tailwind CSS** ‚Äî —Å—Ç–∏–ª–∏–∑–∞—Ü–∏—è
- **React Hook Form** + **Zod** ‚Äî —Ñ–æ—Ä–º—ã –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- **NextAuth.js** ‚Äî –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

### Backend
- **Next.js API Routes** ‚Äî —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- **Prisma** ‚Äî ORM –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –ë–î
- **SQLite** ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (–≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ PostgreSQL)

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- **Telegram Bot API** ‚Äî –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- **YooKassa / –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫** ‚Äî –ø–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã
- **OpenAI** ‚Äî AI-–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤
- **Nodemailer** ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ email
- **QRCode** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–æ–≤

---

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
mb-trust/
‚îú‚îÄ‚îÄ prisma/
‚îÇ   ‚îî‚îÄ‚îÄ schema.prisma          # –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/                    # Next.js App Router
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/                # API endpoints
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/               # –°—Ç—Ä–∞–Ω–∏—Ü—ã –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dashboard/          # –õ–∏—á–Ω—ã–µ –∫–∞–±–∏–Ω–µ—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ executor/           # –°—Ç—Ä–∞–Ω–∏—Ü—ã –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin*/             # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout.tsx          # –ö–æ—Ä–Ω–µ–≤–æ–π layout
‚îÇ   ‚îú‚îÄ‚îÄ components/             # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ui/                 # UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (–∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ business/           # –ë–∏–∑–Ω–µ—Å-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ payment/            # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–ª–∞—Ç–µ–∂–µ–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ layout/              # –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã layout
‚îÇ   ‚îú‚îÄ‚îÄ lib/                    # –£—Ç–∏–ª–∏—Ç—ã –∏ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth.ts             # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NextAuth
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ prisma.ts           # Prisma –∫–ª–∏–µ–Ω—Ç
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ types.ts            # TypeScript —Ç–∏–ø—ã
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ validations/        # Zod —Å—Ö–µ–º—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏
‚îÇ   ‚îú‚îÄ‚îÄ services/               # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ order.service.ts    # –°–µ—Ä–≤–∏—Å –∑–∞–∫–∞–∑–æ–≤
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ image.service.ts    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ middleware.ts           # Next.js middleware
‚îú‚îÄ‚îÄ scripts/                    # –£—Ç–∏–ª–∏—Ç–∞—Ä–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îî‚îÄ‚îÄ package.json
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Å–ª–æ–∏

### 1. Presentation Layer (UI)
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/app/*/page.tsx`, `src/components/*`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
- –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º –Ω–∞ –∫–ª–∏–µ–Ω—Ç–µ
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º UI

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã:**
- `src/app/dashboard/customer/create-order/page.tsx` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `src/app/dashboard/executor/page.tsx` ‚Äî –¥–∞—à–±–æ—Ä–¥ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
- `src/components/business/OrderCard.tsx` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞
- `src/components/business/LocationSelector.tsx` ‚Äî –≤—ã–±–æ—Ä –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏

### 2. API Layer
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/app/api/*/route.ts`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –í—ã–∑–æ–≤ —Å–µ—Ä–≤–∏—Å–æ–≤
- –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ API:**
```
/api/
‚îú‚îÄ‚îÄ orders/              # CRUD –∑–∞–∫–∞–∑–æ–≤
‚îú‚îÄ‚îÄ executions/         # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è–º–∏
‚îú‚îÄ‚îÄ payments/           # –ü–ª–∞—Ç–µ–∂–∏ –∏ –≤—ã–ø–ª–∞—Ç—ã
‚îú‚îÄ‚îÄ auth/               # –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
‚îú‚îÄ‚îÄ admin/              # –ê–¥–º–∏–Ω API
‚îú‚îÄ‚îÄ v1/                 # –ü—É–±–ª–∏—á–Ω–æ–µ API (—Å API –∫–ª—é—á–∞–º–∏)
‚îî‚îÄ‚îÄ utils/              # –£—Ç–∏–ª–∏—Ç—ã (–ø—Ä–æ–≤–µ—Ä–∫–∞ URL –∏ —Ç.–¥.)
```

### 3. Service Layer
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `src/services/*`, `src/lib/*`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞
- –†–∞–±–æ—Ç–∞ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–æ–≤, –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–ö–ª—é—á–µ–≤—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**
- `order.service.ts` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤, —Ä–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π
- `image.service.ts` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å QR-–∫–æ–¥–∞–º–∏
- `telegram.ts` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å Telegram Bot API
- `payment-providers.ts` ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏

### 4. Data Layer
**–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `prisma/schema.prisma`, `src/lib/prisma.ts`

**–û—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å:**
- –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
- –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- –ú–∏–≥—Ä–∞—Ü–∏–∏

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞

```
[Frontend] create-order/page.tsx
    ‚Üì (POST /api/orders)
[API] src/app/api/orders/route.ts
    ‚Üì (–≤—ã–∑–æ–≤ —Å–µ—Ä–≤–∏—Å–∞)
[Service] src/services/order.service.ts
    ‚îú‚îÄ‚îÄ validateCustomer()      # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
    ‚îú‚îÄ‚îÄ calculateOrderPricing()  # –†–∞—Å—á–µ—Ç –∫–æ–º–∏—Å—Å–∏–π
    ‚îú‚îÄ‚îÄ generateQRCode()         # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–∞
    ‚îî‚îÄ‚îÄ createOrderInDB()        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î
    ‚Üì
[Database] Prisma ‚Üí SQLite
```

**–î–µ—Ç–∞–ª–∏:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ñ–æ—Ä–º—É –Ω–∞ `/dashboard/customer/create-order`
2. –§–æ—Ä–º–∞ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ Zod —Å—Ö–µ–º—É (`lib/validations/order.ts`)
3. –ü—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `POST /api/orders`
4. API –≤—ã–∑—ã–≤–∞–µ—Ç `createOrder()` –∏–∑ `order.service.ts`
5. –°–µ—Ä–≤–∏—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø—Ä–∞–≤–∞, —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç —Ü–µ–Ω—ã, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç QR-–∫–æ–¥
6. –ó–∞–∫–∞–∑ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î —á–µ—Ä–µ–∑ Prisma

### 2. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º

```
[Frontend] executor/available/page.tsx
    ‚Üì (GET /api/orders?role=executor)
[API] src/app/api/orders/route.ts (GET)
    ‚Üì (–≥–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è, —Ñ–∏–ª—å—Ç—Ä—ã –ø–æ —É—Ä–æ–≤–Ω—é)
[Database] Prisma query
    ‚Üì
[Frontend] –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤
    ‚Üì (POST /api/executions)
[API] src/app/api/executions/route.ts
    ‚Üì (—Å–æ–∑–¥–∞–Ω–∏–µ Execution)
[Database] Prisma create Execution
    ‚Üì
[Frontend] executor/active/page.tsx
    ‚Üì (–∑–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞)
[API] src/app/api/executions/upload/route.ts
    ‚Üì (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞)
[Database] Prisma update Execution
```

### 3. –ú–æ–¥–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

```
[Admin] admin/moderate/page.tsx
    ‚Üì (GET /api/moderate)
[API] src/app/api/moderate/route.ts
    ‚Üì (—Å–ø–∏—Å–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É)
[Database] Prisma query Executions
    ‚Üì
[Admin] –û–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ
    ‚Üì (POST /api/moderate)
[API] src/app/api/moderate/route.ts
    ‚îú‚îÄ‚îÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ Execution
    ‚îú‚îÄ‚îÄ –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ —Å—Ä–µ–¥—Å—Ç–≤ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
    ‚îî‚îÄ‚îÄ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∑–∞–∫–∞–∑–∞
[Database] Prisma transactions
```

### 4. –ü–ª–∞—Ç–µ–∂–∏ –∏ –≤—ã–ø–ª–∞—Ç—ã

```
[Customer] –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
    ‚Üì (POST /api/payments/create)
[API] src/app/api/payments/create/route.ts
    ‚Üì (—Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ –≤ YooKassa/–ê–ª—å—Ñ–∞)
[External] YooKassa/–ê–ª—å—Ñ–∞-–ë–∞–Ω–∫
    ‚Üì (webhook)
[API] src/app/api/payments/yookassa/webhook/route.ts
    ‚Üì (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞)
[Database] Prisma update User.balance

[Executor] –ó–∞–ø—Ä–æ—Å –≤—ã–ø–ª–∞—Ç—ã
    ‚Üì (POST /api/payouts/request)
[API] src/app/api/payouts/request/route.ts
    ‚Üì (–ø—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–ª–∞–Ω—Å–∞, —Å–æ–∑–¥–∞–Ω–∏–µ Payout)
[Database] Prisma create Payout
    ‚Üì (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—ã–ø–ª–∞—Ç—ã)
[External] Telegram Wallet / –°–ë–ü
```

---

## –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥–µ–ª–∏

#### User (–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)
**–§–∞–π–ª:** `prisma/schema.prisma` (—Å—Ç—Ä–æ–∫–∏ 14-92)

**–ü–æ–ª—è:**
- `id`, `email`, `phone`, `name`, `passwordHash`
- `role` ‚Äî CUSTOMER | EXECUTOR | MODERATOR_ADMIN | SUPER_ADMIN
- `level` ‚Äî NOVICE | VERIFIED | REFERRAL | TOP
- `balance` ‚Äî –±–∞–ª–∞–Ω—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `telegramId`, `telegramUsername` ‚Äî –¥–ª—è Telegram –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `isVerified`, `isBlocked` ‚Äî —Å—Ç–∞—Ç—É—Å—ã

**–°–≤—è–∑–∏:**
- `orders` ‚Äî –∑–∞–∫–∞–∑—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (–∫–∞–∫ –∑–∞–∫–∞–∑—á–∏–∫)
- `executions` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è (–∫–∞–∫ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å)
- `payments` ‚Äî –ø–ª–∞—Ç–µ–∂–∏
- `payouts` ‚Äî –≤—ã–ø–ª–∞—Ç—ã

#### Order (–ó–∞–∫–∞–∑)
**–§–∞–π–ª:** `prisma/schema.prisma` (—Å—Ç—Ä–æ–∫–∏ 152-210)

**–ü–æ–ª—è:**
- `id`, `title`, `description`, `targetUrl`
- `budget`, `reward`, `totalReward` ‚Äî —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ–ª—è
- `socialNetwork` ‚Äî INSTAGRAM | TELEGRAM | VK | TIKTOK | WHATSAPP
- `targetCountry`, `targetRegion`, `targetCity` ‚Äî –≥–µ–æ—Ç–∞—Ä–≥–µ—Ç–∏–Ω–≥
- `qrCode`, `qrCodeUrl`, `processedImageUrl` ‚Äî QR-–∫–æ–¥—ã
- `quantity`, `maxExecutions`, `completedCount` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ
- `deadline`, `status` ‚Äî —Å—Ä–æ–∫–∏ –∏ —Å—Ç–∞—Ç—É—Å
- `pricePerStory`, `platformCommission`, `executorEarnings` ‚Äî —Ü–µ–Ω–æ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ

**–°–≤—è–∑–∏:**
- `customer` ‚Üí User (–∑–∞–∫–∞–∑—á–∏–∫)
- `executions` ‚Üí Execution[] (–≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)

#### Execution (–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ)
**–§–∞–π–ª:** `prisma/schema.prisma` (—Å—Ç—Ä–æ–∫–∏ 213-244)

**–ü–æ–ª—è:**
- `id`, `screenshotUrl`, `notes`
- `status` ‚Äî PENDING | UPLOADED | PENDING_REVIEW | APPROVED | REJECTED | COMPLETED
- `reward` ‚Äî –≤–æ–∑–Ω–∞–≥—Ä–∞–∂–¥–µ–Ω–∏–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—é
- `moderatorId`, `moderatorComment` ‚Äî –¥–∞–Ω–Ω—ã–µ –º–æ–¥–µ—Ä–∞—Ü–∏–∏
- `executorIp`, `executorCity` ‚Äî –∞–Ω—Ç–∏—Ñ—Ä–æ–¥ –¥–∞–Ω–Ω—ã–µ

**–°–≤—è–∑–∏:**
- `order` ‚Üí Order
- `executor` ‚Üí User

#### Payment (–ü–ª–∞—Ç–µ–∂)
**–§–∞–π–ª:** `prisma/schema.prisma` (—Å—Ç—Ä–æ–∫–∏ 247-266)

**–¢–∏–ø—ã:** DEPOSIT | WITHDRAWAL | COMMISSION | EXECUTOR_PAYMENT

#### TrustLevel (–£—Ä–æ–≤–µ–Ω—å –¥–æ–≤–µ—Ä–∏—è)
**–§–∞–π–ª:** `prisma/schema.prisma` (—Å—Ç—Ä–æ–∫–∏ 360-386)

–û–ø—Ä–µ–¥–µ–ª—è–µ—Ç –∫–æ–º–∏—Å—Å–∏–∏ –∏ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —É—Ä–æ–≤–Ω–µ–π –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π.

---

## API Endpoints

### –ü—É–±–ª–∏—á–Ω—ã–µ API (—Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏)

#### –ó–∞–∫–∞–∑—ã
- `GET /api/orders` ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤ (—Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏ –ø–æ —Ä–æ–ª–∏)
- `POST /api/orders` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `GET /api/orders/[id]` ‚Äî –¥–µ—Ç–∞–ª–∏ –∑–∞–∫–∞–∑–∞
- `GET /api/orders/calculator` ‚Äî –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä —Å—Ç–æ–∏–º–æ—Å—Ç–∏

#### –í—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `GET /api/executions` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π
- `POST /api/executions` ‚Äî –ø—Ä–∏–Ω—è—Ç–∏–µ –∑–∞–∫–∞–∑–∞ –≤ —Ä–∞–±–æ—Ç—É
- `POST /api/executions/upload` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞

#### –ü–ª–∞—Ç–µ–∂–∏
- `GET /api/payments` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π
- `POST /api/payments/create` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
- `POST /api/payments/yookassa/webhook` ‚Äî webhook –æ—Ç YooKassa
- `POST /api/payments/alfa/stub` ‚Äî webhook –æ—Ç –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫–∞

#### –í—ã–ø–ª–∞—Ç—ã
- `GET /api/payouts` ‚Äî –∏—Å—Ç–æ—Ä–∏—è –≤—ã–ø–ª–∞—Ç
- `POST /api/payouts/request` ‚Äî –∑–∞–ø—Ä–æ—Å –≤—ã–ø–ª–∞—Ç—ã

### –ê–¥–º–∏–Ω API (—Ç—Ä–µ–±—É—é—Ç –∞–¥–º–∏–Ω-—Å–µ—Å—Å–∏–∏)

#### –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `GET /api/admin/users` ‚Äî —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `POST /api/admin/block-user` ‚Äî –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### –ú–æ–¥–µ—Ä–∞—Ü–∏—è
- `GET /api/moderate` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
- `POST /api/moderate` ‚Äî –æ–¥–æ–±—Ä–µ–Ω–∏–µ/–æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

#### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /api/admin/statistics` ‚Äî –æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `GET /api/analytics` ‚Äî –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

#### –£—Ä–æ–≤–Ω–∏ –¥–æ–≤–µ—Ä–∏—è
- `GET /api/admin/trust-levels` ‚Äî —Å–ø–∏—Å–æ–∫ —É—Ä–æ–≤–Ω–µ–π
- `POST /api/admin/trust-levels` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —É—Ä–æ–≤–Ω—è
- `PUT /api/admin/trust-levels/[id]` ‚Äî –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è

### –ü—É–±–ª–∏—á–Ω–æ–µ API v1 (—Ç—Ä–µ–±—É—é—Ç API –∫–ª—é—á)

**–§–∞–π–ª—ã:** `src/app/api/v1/*/route.ts`

- `GET /api/v1/orders` ‚Äî —Å–ø–∏—Å–æ–∫ –∑–∞–∫–∞–∑–æ–≤
- `POST /api/v1/orders` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `GET /api/v1/executions` ‚Äî —Å–ø–∏—Å–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π
- `POST /api/v1/executions` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è:** —á–µ—Ä–µ–∑ –∑–∞–≥–æ–ª–æ–≤–æ–∫ `X-API-Key` –∏–ª–∏ `Authorization: Bearer <key>`

**–í–∞–ª–∏–¥–∞—Ü–∏—è:** `src/lib/api-middleware.ts`

---

## –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏ —Å–µ—Ä–≤–∏—Å—ã

### UI –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (`src/components/ui/`)

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –≠—Ç–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω—ã –∏ –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–∑–º–µ–Ω—è—Ç—å—Å—è!

- `button.tsx` ‚Äî –∫–Ω–æ–ø–∫–∏
- `card.tsx` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∏
- `input.tsx` ‚Äî –ø–æ–ª—è –≤–≤–æ–¥–∞
- `textarea.tsx` ‚Äî –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π –≤–≤–æ–¥
- `select.tsx` ‚Äî –≤—ã–ø–∞–¥–∞—é—â–∏–µ —Å–ø–∏—Å–∫–∏
- `badge.tsx` ‚Äî –±–µ–π–¥–∂–∏
- `alert.tsx` ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `container.tsx` ‚Äî –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

### –ë–∏–∑–Ω–µ—Å-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã (`src/components/business/`)

- `OrderCard.tsx` ‚Äî –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–∫–∞–∑–∞ —Å –¥–µ–π—Å—Ç–≤–∏—è–º–∏
- `LocationSelector.tsx` ‚Äî –≤—ã–±–æ—Ä –≥–µ–æ–ª–æ–∫–∞—Ü–∏–∏ (—Å—Ç—Ä–∞–Ω–∞/—Ä–µ–≥–∏–æ–Ω/–≥–æ—Ä–æ–¥)
- `CustomerImageUpload.tsx` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –¥–ª—è –∑–∞–∫–∞–∑—á–∏–∫–∞
- `ScreenshotUpload.tsx` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º
- `ExecutionStatusBadge.tsx` ‚Äî –±–µ–π–¥–∂ —Å—Ç–∞—Ç—É—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `ExecutorLimits.tsx` ‚Äî –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è

### –°–µ—Ä–≤–∏—Å—ã (`src/services/`)

#### order.service.ts
**–§—É–Ω–∫—Ü–∏–∏:**
- `validateCustomer()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞
- `calculateOrderPricing()` ‚Äî —Ä–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –∏ –∫–æ–º–∏—Å—Å–∏–π
- `generateQRCode()` ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è QR-–∫–æ–¥–∞ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è
- `createOrder()` ‚Äî –æ—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞
- `createOrderInDB()` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–∫–∞–∑–∞ –≤ –ë–î

#### image.service.ts
**–§—É–Ω–∫—Ü–∏–∏:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- –ù–∞–ª–æ–∂–µ–Ω–∏–µ QR-–∫–æ–¥–æ–≤ –Ω–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### –£—Ç–∏–ª–∏—Ç—ã (`src/lib/`)

#### auth.ts
**–§–∞–π–ª:** `src/lib/auth.ts`

–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è NextAuth —Å –¥–≤—É–º—è –ø—Ä–æ–≤–∞–π–¥–µ—Ä–∞–º–∏:
1. **Credentials** ‚Äî –ª–æ–≥–∏–Ω –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É/–ø–∞—Ä–æ–ª—é
2. **Telegram** ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram ID

**–°–µ—Å—Å–∏–∏:** JWT —Å—Ç—Ä–∞—Ç–µ–≥–∏—è, —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è 30 –¥–Ω–µ–π

#### prisma.ts
**–§–∞–π–ª:** `src/lib/prisma.ts`

Singleton Prisma –∫–ª–∏–µ–Ω—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π hot-reload –≤ development.

#### types.ts
**–§–∞–π–ª:** `src/lib/types.ts`

TypeScript —Ç–∏–ø—ã –¥–ª—è UI:
- `OrderUI` ‚Äî —Ç–∏–ø –∑–∞–∫–∞–∑–∞ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
- `ExecutionUI` ‚Äî —Ç–∏–ø –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- `UserMini` ‚Äî –º–∏–Ω–∏-–ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

#### validations/order.ts
**–§–∞–π–ª:** `src/lib/validations/order.ts`

Zod —Å—Ö–µ–º—ã –¥–ª—è –≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ñ–æ—Ä–º —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞.

#### telegram.ts
**–§–∞–π–ª:** `src/lib/telegram.ts`

–†–∞–±–æ—Ç–∞ —Å Telegram Bot API:
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–æ—Ä–∏—Å

#### payment-providers.ts
**–§–∞–π–ª:** `src/lib/payment-providers.ts`

–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø–ª–∞—Ç–µ–∂–Ω—ã–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏:
- YooKassa
- –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

### Middleware

**–§–∞–π–ª:** `src/middleware.ts` (–∫–æ—Ä–Ω–µ–≤–æ–π) –∏ `middleware.ts` (–≤ –∫–æ—Ä–Ω–µ)

**–§—É–Ω–∫—Ü–∏–∏:**
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
3. –†–µ–¥–∏—Ä–µ–∫—Ç—ã –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –≤—Ö–æ–¥–∞

**–ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –º–∞—Ä—à—Ä—É—Ç—ã:**
- `/executor/*` ‚Äî —Ç–æ–ª—å–∫–æ EXECUTOR
- `/dashboard/customer/*` ‚Äî —Ç–æ–ª—å–∫–æ CUSTOMER
- `/dashboard/executor/*` ‚Äî —Ç–æ–ª—å–∫–æ EXECUTOR
- `/admin/*` ‚Äî —Ç–æ–ª—å–∫–æ MODERATOR_ADMIN –∏–ª–∏ SUPER_ADMIN

### NextAuth

**–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `src/lib/auth.ts`

**–°—Ç—Ä–∞—Ç–µ–≥–∏—è:** JWT (–±–µ–∑ —Å–µ—Å—Å–∏–π –≤ –ë–î)

**–ü—Ä–æ–≤–∞–π–¥–µ—Ä—ã:**
1. Credentials ‚Äî —Ç–µ–ª–µ—Ñ–æ–Ω + –ø–∞—Ä–æ–ª—å
2. Telegram ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ Telegram ID

**Callbacks:**
- `jwt` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ —Ç–æ–∫–µ–Ω
- `session` ‚Äî –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–æ–∫–µ–Ω–∞ –≤ —Å–µ—Å—Å–∏—é

### API Middleware

**–§–∞–π–ª:** `src/lib/api-middleware.ts`

**–§—É–Ω–∫—Ü–∏–∏:**
- `validateApiKey()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ API –∫–ª—é—á–∞ –¥–ª—è v1 API
- `checkPermission()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

**API –∫–ª—é—á–∏:** —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `ApiKey` —Å –ø–æ–ª—è–º–∏:
- `key` ‚Äî —Å–∞–º –∫–ª—é—á
- `permissions` ‚Äî –º–∞—Å—Å–∏–≤ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π (JSON)
- `isActive` ‚Äî –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ –∫–ª—é—á
- `expiresAt` ‚Äî —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è

### –ê–¥–º–∏–Ω-–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

**–§–∞–π–ª:** `src/app/api/admin/auth/login/route.ts`

–û—Ç–¥–µ–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è –∞–¥–º–∏–Ω–æ–≤:
- –°–µ—Å—Å–∏–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ `AdminSession`
- –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ SMS/Email
- –ö–æ–¥—ã –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ `AdminVerificationCode`

---

## –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

### Telegram Bot

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:** `src/lib/telegram-init-server.ts`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ Telegram
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å—Ç–æ—Ä–∏—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- –û—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**Webhook:** `/api/admin/telegram/webhook`

### –ü–ª–∞—Ç–µ–∂–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã

#### YooKassa
**Endpoints:**
- `POST /api/payments/yookassa/webhook` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook
- `GET /api/payments/yookassa/success` ‚Äî —É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
- `GET /api/payments/yookassa/cancel` ‚Äî –æ—Ç–º–µ–Ω–∞ –æ–ø–ª–∞—Ç—ã

#### –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫
**Endpoints:**
- `POST /api/payments/alfa/stub` ‚Äî –æ–±—Ä–∞–±–æ—Ç–∫–∞ webhook
- `GET /api/payments/alfa/success` ‚Äî —É—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞
- `GET /api/payments/alfa/cancel` ‚Äî –æ—Ç–º–µ–Ω–∞ –æ–ø–ª–∞—Ç—ã

### OpenAI

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:** AI-–≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Å–∫—Ä–∏–Ω—à–æ—Ç–æ–≤

**Endpoint:** `POST /api/ai/verify-screenshot`

---

## –í–∞–∂–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

- `package.json` ‚Äî –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
- `next.config.ts` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Next.js
- `tailwind.config.js` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Tailwind
- `tsconfig.json` ‚Äî –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è TypeScript
- `.env.example` ‚Äî –ø—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

### –°—Ö–µ–º–∞ –ë–î

- `prisma/schema.prisma` ‚Äî –ø–æ–ª–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ú–∏–≥—Ä–∞—Ü–∏–∏: `npx prisma migrate dev`

### –ü—Ä–∞–≤–∏–ª–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

- `.cursorrules` ‚Äî –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Cursor AI
- **‚ö†Ô∏è –ù–ï –ú–ï–ù–Ø–¢–¨:** `src/components/ui/*`, `src/app/globals.css`, `tailwind.config.ts`

---

## –¢–∏–ø–∏—á–Ω—ã–µ –∑–∞–¥–∞—á–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ API endpoint

1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `src/app/api/[route]/route.ts`
2. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ `GET`, `POST`, `PUT`, `DELETE`
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `NextRequest` –∏ `NextResponse`
4. –í–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ Zod
5. –í—ã–∑—ã–≤–∞—Ç—å —Å–µ—Ä–≤–∏—Å—ã –∏–∑ `src/services/`
6. –í–æ–∑–≤—Ä–∞—â–∞—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã

1. –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `src/app/[route]/page.tsx`
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑ `src/components/ui/`
3. –î–ª—è –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∞–Ω–∏—Ü –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤ `middleware.ts`
4. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useSession()` –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

1. –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ö–µ–º—É –≤ `prisma/schema.prisma`
2. –í—ã–ø–æ–ª–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é: `npx prisma db push` –∏–ª–∏ `npx prisma migrate dev`
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `prisma` –∏–∑ `src/lib/prisma.ts`

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

1. –°–æ–∑–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–º —Å–µ—Ä–≤–∏—Å–µ (`src/services/`)
2. –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å —É—Ç–∏–ª–∏—Ç—É –≤ `src/lib/`
3. –í—ã–∑—ã–≤–∞—Ç—å –∏–∑ API endpoints –∏–ª–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

---

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–§–∞–π–ª:** `.env.example`

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ:**
- `DATABASE_URL` ‚Äî URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- `NEXTAUTH_SECRET` ‚Äî —Å–µ–∫—Ä–µ—Ç –¥–ª—è NextAuth
- `NEXTAUTH_URL` ‚Äî URL –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

**Telegram:**
- `TELEGRAM_BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
- `NEXT_PUBLIC_TELEGRAM_BOT_USERNAME` ‚Äî username –±–æ—Ç–∞

**–ü–ª–∞—Ç–µ–∂–∏:**
- `YOOKASSA_SHOP_ID` ‚Äî ID –º–∞–≥–∞–∑–∏–Ω–∞ YooKassa
- `YOOKASSA_SECRET_KEY` ‚Äî —Å–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á YooKassa
- `ALFA_MERCHANT_KEY` ‚Äî –∫–ª—é—á –ê–ª—å—Ñ–∞-–ë–∞–Ω–∫–∞

**Email/SMS:**
- `SMTP_*` ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ SMTP
- `SMS_API_KEY` ‚Äî –∫–ª—é—á SMS API

---

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–µ–∫—Ç–∞

### Development

```bash
npm install
npx prisma generate
npx prisma db push
npm run dev
```

### Production

```bash
npm run build
npm start
```

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

```bash
npx prisma migrate dev      # –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
npx prisma db push          # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏
npx prisma studio           # –û—Ç–∫—Ä—ã—Ç—å Prisma Studio
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

```bash
npm run lint                # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞
npm run lint:fix            # –ê–≤—Ç–æ–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
npm run db:studio          # Prisma Studio
```

---

## –ö–æ–Ω—Ç–∞–∫—Ç—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –≤–æ–ø—Ä–æ—Å–æ–≤ –ø–æ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ –æ–±—Ä–∞—â–∞–π—Ç–µ—Å—å –∫:
- –°—Ö–µ–º–µ –ë–î: `prisma/schema.prisma`
- API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏: `INTERNAL_API_DOCS.md`
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–º –ø—Ä–∏–º–µ—Ä–∞–º –≤ –∫–æ–¥–µ

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2024
