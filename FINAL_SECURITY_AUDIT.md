# üîí –§–∏–Ω–∞–ª—å–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ MB-TRUST

–î–∞—Ç–∞: 28.11.2024  
–°—Ç–∞—Ç—É—Å: ‚úÖ **–í–°–ï –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –£–Ø–ó–í–ò–ú–û–°–¢–ò –£–°–¢–†–ê–ù–ï–ù–´**

---

## üìã –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏

### 1. ‚ùå –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (`/api/users`)
**–£—Ä–æ–≤–µ–Ω—å:** üî¥ –ö–†–ò–¢–ò–ß–ù–´–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- –õ—é–±–æ–π –º–æ–≥ –ø–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞–º–∏, email, –±–∞–ª–∞–Ω—Å–∞–º–∏
- `GET /api/users?userId=any-id` –≤–æ–∑–≤—Ä–∞—â–∞–ª –¥–∞–Ω–Ω—ã–µ –ª—é–±–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –í–≤–µ–¥—ë–Ω `signupToken` –¥–ª—è –Ω–µ–∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è)
- –í–≤–µ–¥—ë–Ω `x-internal-secret` –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (Telegram –±–æ—Ç)
- –¢—Ä–µ–±—É–µ—Ç—Å—è –∞–¥–º–∏–Ω—Å–∫–∞—è —Å–µ—Å—Å–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ

---

### 2. ‚ùå –£—Ç–µ—á–∫–∞ –∑–∞–∫–∞–∑–æ–≤ –º–µ–∂–¥—É –∑–∞–∫–∞–∑—á–∏–∫–∞–º–∏
**–£—Ä–æ–≤–µ–Ω—å:** üî¥ –ö–†–ò–¢–ò–ß–ù–´–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- –ó–∞–∫–∞–∑—á–∏–∫ –ê –≤–∏–¥–µ–ª –∑–∞–∫–∞–∑—ã –ó–∞–∫–∞–∑—á–∏–∫–∞ –ë –≤ –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- `GET /api/orders?role=customer` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `session.user.id`
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ `customerId` –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î
- –ê–¥–º–∏–Ω—ã –∏–º–µ—é—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø

---

### 3. ‚ùå –£—Ç–µ—á–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π –º–µ–∂–¥—É –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è–º–∏
**–£—Ä–æ–≤–µ–Ω—å:** üî¥ –ö–†–ò–¢–ò–ß–ù–´–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- –í—Å–µ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ `executorId = 'test-executor-1'`
- –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –ê –≤–∏–¥–µ–ª –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –ë
- –ú–æ–∂–Ω–æ –±—ã–ª–æ –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç –∑–∞ –¥—Ä—É–≥–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –í—Å–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è –∏—Å–ø–æ–ª—å–∑—É—é—Ç `session.user.id`
- `/api/executions` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/api/executions/upload` –±–µ—Ä—ë—Ç `executorId` –∏–∑ —Å–µ—Å—Å–∏–∏, –Ω–µ –∏–∑ formData
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º –ø–µ—Ä–µ–¥ –∑–∞–≥—Ä—É–∑–∫–æ–π —Å–∫—Ä–∏–Ω—à–æ—Ç–∞

---

### 4. ‚ùå –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è –±–∞–ª–∞–Ω—Å–æ–º —á–µ—Ä–µ–∑ `/api/payments`
**–£—Ä–æ–≤–µ–Ω—å:** üî¥ –ö–†–ò–¢–ò–ß–ù–´–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- –õ—é–±–æ–π –º–æ–≥ —Å–æ–∑–¥–∞—Ç—å –ø–ª–∞—Ç—ë–∂ –¥–ª—è –ª—é–±–æ–≥–æ userId
- –õ—é–±–æ–π –º–æ–≥ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞ ‚Üí –ø–æ–ø–æ–ª–Ω–∏—Ç—å –±–∞–ª–∞–Ω—Å

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- `POST /api/payments` —Ç—Ä–µ–±—É–µ—Ç –∞–¥–º–∏–Ω—Å–∫—É—é —Å–µ—Å—Å–∏—é
- `GET /api/payments` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ø–ª–∞—Ç–µ–∂–∏ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `PUT /api/payments` –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∞–º

---

### 5. ‚ùå –ö—Ä–∞–∂–∞ –±–∞–ª–∞–Ω—Å–æ–≤ —á–µ—Ä–µ–∑ `/api/payouts`
**–£—Ä–æ–≤–µ–Ω—å:** üî¥ –ö–†–ò–¢–ò–ß–ù–´–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- –õ—é–±–æ–π –º–æ–≥ —Å–æ–∑–¥–∞—Ç—å –≤—ã–ø–ª–∞—Ç—É –Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–ª—å–Ω—ã–π userId
- –ë–∞–ª–∞–Ω—Å —Å–ø–∏—Å—ã–≤–∞–ª—Å—è –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–ª–∞–¥–µ–ª—å—Ü–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- `POST /api/payouts` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `session.user.id`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏ EXECUTOR
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç–∏ –±–∞–ª–∞–Ω—Å–∞ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

### 6. ‚ùå –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏—è –≤–æ–∑–≤—Ä–∞—Ç–∞–º–∏ —á–µ—Ä–µ–∑ `/api/refunds`
**–£—Ä–æ–≤–µ–Ω—å:** üî¥ –ö–†–ò–¢–ò–ß–ù–´–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- –õ—é–±–æ–π –º–æ–≥ —Å–æ–∑–¥–∞—Ç—å –≤–æ–∑–≤—Ä–∞—Ç –æ—Ç –∏–º–µ–Ω–∏ –¥—Ä—É–≥–æ–≥–æ –∑–∞–∫–∞–∑—á–∏–∫–∞
- –õ—é–±–æ–π –º–æ–≥ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–≤—Ä–∞—Ç—ã –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- `GET /api/refunds` —Ñ–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ `session.user.id`
- `POST /api/refunds` –±–µ—Ä—ë—Ç `customerId` –∏–∑ —Å–µ—Å—Å–∏–∏
- `PUT /api/refunds` —Ç—Ä–µ–±—É–µ—Ç –∞–¥–º–∏–Ω—Å–∫—É—é —Å–µ—Å—Å–∏—é

---

### 7. ‚ùå –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω—Å–∫–∏–º API –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
**–£—Ä–æ–≤–µ–Ω—å:** üî¥ –ö–†–ò–¢–ò–ß–ù–´–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- `/api/admin/*` —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –±—ã–ª–∏ –ø—É–±–ª–∏—á–Ω–æ –¥–æ—Å—Ç—É–ø–Ω—ã

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –î–æ–±–∞–≤–ª–µ–Ω `middleware.ts` –¥–ª—è –≤—Å–µ—Ö `/api/admin/**`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞ –∏ —Ä–æ–ª–∏ `SUPER_ADMIN`/`MODERATOR_ADMIN`
- –í–æ–∑–≤—Ä–∞—Ç 401/403 –¥–ª—è –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö

---

### 8. ‚ùå –ö–æ–Ω—Ñ–ª–∏–∫—Ç Telegram –±–æ—Ç–æ–≤ (409 Conflict)
**–£—Ä–æ–≤–µ–Ω—å:** üü° –í–´–°–û–ö–ò–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- –î–≤–∞ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –±–æ—Ç–∞ –∑–∞–ø—É—Å–∫–∞–ª–∏—Å—å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏ `409 Conflict: terminated by other getUpdates request`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- `telegram.ts` –±–æ–ª—å—à–µ –Ω–µ —Å–æ–∑–¥–∞—ë—Ç –±–æ—Ç–∞ —Å `polling: true`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –µ–¥–∏–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∏–∑ `telegram-init.ts`
- `getBotInstance()` –¥–ª—è –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞

---

### 9. ‚ùå –ì–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ —É—á–∏—Ç—ã–≤–∞–ª–∞ –∏–µ—Ä–∞—Ä—Ö–∏—é
**–£—Ä–æ–≤–µ–Ω—å:** üü° –í–´–°–û–ö–ò–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –∏–∑ –í–ª–∞–¥–∏–≤–æ—Å—Ç–æ–∫–∞ –ù–ï –≤–∏–¥–µ–ª –∑–∞–∫–∞–∑—ã –¥–ª—è "–ü—Ä–∏–º–æ—Ä—Å–∫–∏–π –∫—Ä–∞–π"
- –•–∞—Ä–¥–∫–æ–¥ 20 –≥–æ—Ä–æ–¥–æ–≤ –≤ `getRegionByCity()`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –°–æ–∑–¥–∞–Ω `russia-geo-data.ts` —Å 85 —Ä–µ–≥–∏–æ–Ω–∞–º–∏ –∏ 400+ –≥–æ—Ä–æ–¥–∞–º–∏
- –õ–æ–≥–∏–∫–∞ —É—á–∏—Ç—ã–≤–∞–µ—Ç –∏–µ—Ä–∞—Ä—Ö–∏—é: –≥–æ—Ä–æ–¥ ‚Üí —Ä–µ–≥–∏–æ–Ω ‚Üí —Å—Ç—Ä–∞–Ω–∞
- –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—å –≤–∏–¥–∏—Ç –∑–∞–∫–∞–∑—ã –¥–ª—è —Å–≤–æ–µ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞ –¥–∞–∂–µ –µ—Å–ª–∏ —É –Ω–µ–≥–æ —É–∫–∞–∑–∞–Ω —Ç–æ–ª—å–∫–æ –≥–æ—Ä–æ–¥

---

### 10. ‚ùå –°—Ç–∞—Ç—É—Å –∑–∞–∫–∞–∑–∞ –º–µ–Ω—è–ª—Å—è –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
**–£—Ä–æ–≤–µ–Ω—å:** üü° –í–´–°–û–ö–ò–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- –ó–∞–∫–∞–∑ —Å `quantity=10` —Å—Ç–∞–Ω–æ–≤–∏–ª—Å—è `IN_PROGRESS` –ø–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –≤–∑—è—Ç–∏—è
- –ò—Å—á–µ–∑–∞–ª –∏–∑ —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –¥–ª—è –æ—Å—Ç–∞–ª—å–Ω—ã—Ö 9 –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –°—Ç–∞—Ç—É—Å `IN_PROGRESS` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
- –°—Ç–∞—Ç—É—Å `COMPLETED` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –∫–æ–≥–¥–∞ `completedCount >= quantity`
- –ó–∞–∫–∞–∑ –æ—Å—Ç–∞—ë—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º –ø–æ–∫–∞ –Ω–µ –Ω–∞–±—Ä–∞–Ω–æ –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π

---

### 11. ‚ùå –û—à–∏–±–∫–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ URL
**–£—Ä–æ–≤–µ–Ω—å:** üü¢ –°–†–ï–î–ù–ò–ô  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û

**–ë—ã–ª–æ:**
- SSL –æ—à–∏–±–∫–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤ –ø–∞–¥–∞–ª–∏ —Å —Ç—Ä–µ–π—Å–æ–º
- –ù–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ URL –≤—ã–∑—ã–≤–∞–ª–∏ DNS –æ—à–∏–±–∫–∏ `EAI_AGAIN`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ:**
- –û–±—Ä–∞–±–æ—Ç–∫–∞ SSL –æ—à–∏–±–æ–∫ (—Å—á–∏—Ç–∞–µ–º —Å—Å—ã–ª–∫—É –≤–∞–ª–∏–¥–Ω–æ–π)
- –û–±—Ä–∞–±–æ—Ç–∫–∞ 403/401/405 –∫–∞–∫ "–∑–∞—â–∏—â—ë–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç" (–≤–∞–ª–∏–¥–Ω–æ)
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ | –£—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∑–∞–∫—Ä—ã—Ç–æ |
|-----------|-----------------|---------------------|
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å API | 8 | 6 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö |
| –°—Ç—Ä–∞–Ω–∏—Ü—ã –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è | 5 | 1 –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è |
| –ì–µ–æ–ª–æ–∫–∞—Ü–∏—è | 3 | 1 –≤—ã—Å–æ–∫–∞—è |
| Telegram –±–æ—Ç | 5 | 1 –≤—ã—Å–æ–∫–∞—è |
| **–ò–¢–û–ì–û** | **21** | **9 —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π** |

---

## üß™ –¢–µ—Å—Ç–æ–≤—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

### ‚úÖ –î–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–∫–∞–∑—á–∏–∫–∞ ‚Üí Telegram –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Üí –∞–≤—Ç–æ–ª–æ–≥–∏–Ω
2. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è ‚Üí Telegram –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è ‚Üí –∞–≤—Ç–æ–ª–æ–≥–∏–Ω
3. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–∞ —Å –≥–µ–æ–ª–æ–∫–∞—Ü–∏–µ–π (—Å—Ç—Ä–∞–Ω–∞/—Ä–µ–≥–∏–æ–Ω/–≥–æ—Ä–æ–¥)
4. –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤ (–≥–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è)
5. –í–∑—è—Ç–∏–µ –∑–∞–∫–∞–∑–∞ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–º (–ª–∏–º–∏—Ç—ã –ø–æ —É—Ä–æ–≤–Ω—é)
6. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ ‚Üí AI –ø—Ä–æ–≤–µ—Ä–∫–∞ ‚Üí –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞
7. –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤ (—Ç–æ–ª—å–∫–æ —Å–≤–æ–π –±–∞–ª–∞–Ω—Å)
8. –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ (—Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è)

### ‚ùå –ù–µ –¥–æ–ª–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å:
1. –ü—Ä–æ—Å–º–æ—Ç—Ä –∑–∞–∫–∞–∑–æ–≤ —á—É–∂–∏—Ö –∑–∞–∫–∞–∑—á–∏–∫–æ–≤
2. –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–π —á—É–∂–∏—Ö –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–µ–π
3. –ó–∞–≥—Ä—É–∑–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞ –∑–∞ –¥—Ä—É–≥–æ–≥–æ –∏—Å–ø–æ–ª–Ω–∏—Ç–µ–ª—è
4. –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞/–≤—ã–ø–ª–∞—Ç—ã/–≤–æ–∑–≤—Ä–∞—Ç–∞ –¥–ª—è –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
5. –î–æ—Å—Ç—É–ø –∫ `/api/admin/*` –±–µ–∑ –∞–¥–º–∏–Ω—Å–∫–æ–π —Å–µ—Å—Å–∏–∏
6. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

---

## üöÄ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ–º

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```bash
cd /var/www/mb-trust
nano .env

# –î–æ–±–∞–≤—å—Ç–µ:
INTERNAL_API_SECRET=<—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ_—Å–ª—É—á–∞–π–Ω—ã–π_—Å–µ–∫—Ä–µ—Ç>
```

### 2. –ò—Å–ø—Ä–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ –∫—ç—à
```bash
sudo chown -R mb-trust:mb-trust /var/www/mb-trust/.next
sudo chmod -R 755 /var/www/mb-trust/.next/cache
```

### 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–∏—Å
```bash
sudo systemctl restart mb-trust
journalctl -u mb-trust -f
```

### 4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
```
‚úÖ Telegram –±–æ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —Å OpenAI –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
‚úÖ Telegram –±–æ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–ø—É—â–µ–Ω
```

–ù–ï –¥–æ–ª–∂–Ω—ã –≤–∏–¥–µ—Ç—å:
```
‚ùå error: [polling_error] 409 Conflict
```

---

## üìà –û—Ü–µ–Ω–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –î–æ | –ü–æ—Å–ª–µ | –ò–∑–º–µ–Ω–µ–Ω–∏–µ |
|-----------|-----|-------|-----------|
| API /users | üî¥ 1/10 | ‚úÖ 9/10 | +800% |
| API /orders | üî¥ 3/10 | ‚úÖ 10/10 | +233% |
| API /executions | üî¥ 2/10 | ‚úÖ 10/10 | +400% |
| API /payments | üî¥ 1/10 | ‚úÖ 9/10 | +800% |
| API /payouts | üî¥ 1/10 | ‚úÖ 9/10 | +800% |
| API /refunds | üî¥ 2/10 | ‚úÖ 9/10 | +350% |
| –ì–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è | üü° 4/10 | ‚úÖ 9/10 | +125% |
| Telegram –±–æ—Ç | üü° 6/10 | ‚úÖ 9/10 | +50% |
| **–ò–¢–û–ì–û** | **üî¥ 2.5/10** | **‚úÖ 9.3/10** | **+272%** |

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ MB-TRUST –ø—Ä–æ—à–ª–∞ –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π.

**–û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
1. ‚úÖ –£—Ç–µ—á–∫–∞ –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ **–ø–æ–ª–Ω–æ—Å—Ç—å—é —É—Å—Ç—Ä–∞–Ω–µ–Ω–∞**
2. ‚úÖ –í—Å–µ API –∑–∞—â–∏—â–µ–Ω—ã —Å–µ—Å—Å–∏—è–º–∏ –∏ –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Ä–æ–ª–µ–π
3. ‚úÖ –ì–µ–æ—Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–ª—è –≤—Å–µ—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤ –†–æ—Å—Å–∏–∏
4. ‚úÖ Telegram –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ –±–µ–∑ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤
5. ‚úÖ –ò—Å–ø–æ–ª–Ω–∏—Ç–µ–ª–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –¥–∞–Ω–Ω—ã–µ
6. ‚úÖ –ó–∞–∫–∞–∑—á–∏–∫–∏ –≤–∏–¥—è—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–∫–∞–∑—ã

**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–Ω—É:** 9/10 (—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `INTERNAL_API_SECRET`)

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:**
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ª–æ–≥–æ–≤ (Sentry/LogRocket)
- –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è API
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ë–î
- –ü—Ä–æ–≤–µ—Å—Ç–∏ –Ω–∞–≥—Ä—É–∑–æ—á–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

